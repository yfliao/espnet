<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>espnet2.gan_codec package &mdash; ESPnet 202402 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="espnet2.diar package" href="espnet2.diar.html" />
    <link rel="prev" title="espnet2.samplers package" href="espnet2.samplers.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            ESPnet
          </a>
              <div class="version">
                202402
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p><span class="caption-text">Tutorial:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Common usages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallelization.html">Using job scheduling system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker.html">Docker</a></li>
</ul>
<p><span class="caption-text">ESPnet1:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../espnet1_tutorial.html">Usage</a></li>
</ul>
<p><span class="caption-text">ESPnet2:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../espnet2_tutorial.html">ESPnet2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../espnet2_tutorial.html#instruction-for-run-sh">Instruction for run.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../espnet2_training_option.html">Change the configuration for training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../espnet2_format_wav_scp.html">Converting audio file formats using format_wav_scp.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="../espnet2_task.html">Task class and data input system for training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../espnet2_distributed.html">Distributed training</a></li>
</ul>
<p><span class="caption-text">Notebook:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/SLU/2pass_slu_demo.html">ESPNET 2 pass SLU Demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/ASR/asr_transfer_learning_demo.html"><strong>Use transfer learning for ASR in ESPnet2</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/ASR/asr_transfer_learning_demo.html#Abstract">Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/ASR/asr_transfer_learning_demo.html#ESPnet-installation-(about-10-minutes-in-total)">ESPnet installation (about 10 minutes in total)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/ASR/asr_transfer_learning_demo.html#mini_an4-recipe-as-a-transfer-learning-example">mini_an4 recipe as a transfer learning example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/ASR/streaming_asr_demo.html">ESPnet2 real streaming Transformer demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/ASR/asr_realtime_demo.html">ESPnet2-ASR realtime demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/TTS/tts_realtime_demo.html">ESPnet2-TTS realtime demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/SE/se_demo_for_waspaa_2021.html">ESPnet Speech Enhancement Demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/SE/se_demo_for_waspaa_2021.html#Contents">Contents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/SE/se_demo_for_waspaa_2021.html#(1)-Tutorials-on-the-Basic-Usage">(1) Tutorials on the Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/SE/se_demo_for_waspaa_2021.html#(2)-Tutorials-on-Contributing-to-ESPNet-SE-Project">(2) Tutorials on Contributing to ESPNet-SE Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/SE/se_demo.html">ESPnet Speech Enhancement Demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/Others/onnx_conversion_demo.html">espnet_onnx demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/Others/onnx_conversion_demo.html#Install-Dependency">Install Dependency</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/Others/onnx_conversion_demo.html#Export-your-model">Export your model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/Others/onnx_conversion_demo.html#Inference-with-onnx">Inference with onnx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Demo/Others/onnx_conversion_demo.html#Using-streaming-model">Using streaming model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechRecognition_Fall2022/recipe_tutorial.html">CMU 11751/18781 Fall 2022: ESPnet Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechRecognition_Fall2022/recipe_tutorial.html#Install-ESPnet">Install ESPnet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechRecognition_Fall2022/recipe_tutorial.html#Run-an-existing-recipe">Run an existing recipe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechRecognition_Fall2022/recipe_tutorial.html#Make-a-new-recipe">Make a new recipe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechRecognition_Fall2022/recipe_tutorial.html#Additional-resources">Additional resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechRecognition_Fall2022/new_task_tutorial.html">CMU 11751/18781 Fall 2022: ESPnet Tutorial2 (New task)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechRecognition_Fall2022/new_task_tutorial.html#Install-ESPnet-(Almost-same-procedure-as-your-first-tutorial)">Install ESPnet (Almost same procedure as your first tutorial)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechRecognition_Fall2022/new_task_tutorial.html#What-we-provide-you-and-what-you-need-to-proceed">What we provide you and what you need to proceed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechRecognition_Fall2021/general_tutorial.html">CMU 11751/18781 2021: ESPnet Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechRecognition_Fall2021/general_tutorial.html#Run-an-inference-example">Run an inference example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechRecognition_Fall2021/general_tutorial.html#Full-installation">Full installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechRecognition_Fall2021/general_tutorial.html#Run-a-recipe-example">Run a recipe example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechProcessing_Spring2023/assignment6_slu.html">CMU 11492/11692 Spring 2023: Spoken Language Understanding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechProcessing_Spring2023/assignment1_espnet-tutorial.html">CMU 11492/11692 Spring 2023: ESPnet Tutorial2 (New task)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechProcessing_Spring2023/assignment1_espnet-tutorial.html#Install-ESPnet-(Almost-same-procedure-as-your-first-tutorial)">Install ESPnet (Almost same procedure as your first tutorial)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechProcessing_Spring2023/assignment1_espnet-tutorial.html#What-we-provide-you-and-what-you-need-to-proceed">What we provide you and what you need to proceed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechProcessing_Spring2023/s2st_demo.html">ESPnet-S2ST realtime demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechProcessing_Spring2023/assignment3_spk.html">CMU 11492/11692 Spring 2023: Speaker Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechProcessing_Spring2023/assignment5_st.html">CMU 11492/11692 Spring 2023: Speech Translation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechProcessing_Spring2023/assignment0_data-prep.html">CMU 11492/11692 Spring 2023: Data preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechProcessing_Spring2023/assignment0_data-prep.html#Data-preparation-in-ESPnet">Data preparation in ESPnet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechProcessing_Spring2023/assignment7_se.html">CMU 11492/11692 Spring 2023: Speech Enhancement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechProcessing_Spring2023/assignment7_se.html#Contents">Contents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechProcessing_Spring2023/assignment4_ssl.html">CMU 11751/18781 Fall 2022: ESPnet Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechProcessing_Spring2023/assignment4_ssl.html#Install-ESPnet">Install ESPnet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechProcessing_Spring2023/assignment4_ssl.html#Run-an-existing-recipe">Run an existing recipe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet2/Course/CMU_SpeechProcessing_Spring2023/assignment8_tts.html">CMU 11492/11692 Spring 2023: Text to Speech</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet1/asr_recipe.html">Speech Recognition (Recipe)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet1/pretrained.html">Pretrained Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet1/asr_library.html">Speech Recognition (Library)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet1/tts_recipe.html">Text-to-Speech (Recipe)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet1/tts_realtime_demo.html">ESPnet real time E2E-TTS demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/ESPnet1/st_demo.html">ESPnet Speech Translation Demonstration</a></li>
</ul>
<p><span class="caption-text">Package Reference:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="espnet.tts.html">espnet.tts package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.transform.html">espnet.transform package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.bin.html">espnet.bin package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.utils.html">espnet.utils package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.nets.html">espnet.nets package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.vc.html">espnet.vc package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.st.html">espnet.st package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.distributed.html">espnet.distributed package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.optimizer.html">espnet.optimizer package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.mt.html">espnet.mt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.lm.html">espnet.lm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.asr.html">espnet.asr package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet.scheduler.html">espnet.scheduler package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.tts.html">espnet2.tts package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.optimizers.html">espnet2.optimizers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.bin.html">espnet2.bin package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.slu.html">espnet2.slu package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.utils.html">espnet2.utils package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.iterators.html">espnet2.iterators package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.tasks.html">espnet2.tasks package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.train.html">espnet2.train package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.text.html">espnet2.text package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.tts2.html">espnet2.tts2 package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.fileio.html">espnet2.fileio package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.torch_utils.html">espnet2.torch_utils package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.st.html">espnet2.st package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.enh.html">espnet2.enh package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.s2st.html">espnet2.s2st package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.main_funcs.html">espnet2.main_funcs package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.gan_svs.html">espnet2.gan_svs package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.spk.html">espnet2.spk package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.uasr.html">espnet2.uasr package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.speechlm.html">espnet2.speechlm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.mt.html">espnet2.mt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.lm.html">espnet2.lm package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.s2t.html">espnet2.s2t package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.schedulers.html">espnet2.schedulers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.asr.html">espnet2.asr package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.layers.html">espnet2.layers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.asvspoof.html">espnet2.asvspoof package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.svs.html">espnet2.svs package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.gan_tts.html">espnet2.gan_tts package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.asr_transducer.html">espnet2.asr_transducer package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.samplers.html">espnet2.samplers package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">espnet2.gan_codec package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-init-1">espnet2.gan_codec.__init__</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-espnet-model-1">espnet2.gan_codec.espnet_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-abs-gan-codec-1">espnet2.gan_codec.abs_gan_codec</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-encodec-init-1">espnet2.gan_codec.encodec.__init__</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-encodec-encodec-1">espnet2.gan_codec.encodec.encodec</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-dac-dac-1">espnet2.gan_codec.dac.dac</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-dac-init-1">espnet2.gan_codec.dac.__init__</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-init-1">espnet2.gan_codec.shared.__init__</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-discriminator-msstft-conv-1">espnet2.gan_codec.shared.discriminator.msstft_conv</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-discriminator-init-1">espnet2.gan_codec.shared.discriminator.__init__</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-discriminator-msstft-discriminator-1">espnet2.gan_codec.shared.discriminator.msstft_discriminator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-discriminator-msmpmb-discriminator-1">espnet2.gan_codec.shared.discriminator.msmpmb_discriminator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-discriminator-stft-discriminator-1">espnet2.gan_codec.shared.discriminator.stft_discriminator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-loss-init-1">espnet2.gan_codec.shared.loss.__init__</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-loss-loss-balancer-1">espnet2.gan_codec.shared.loss.loss_balancer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-loss-freq-loss-1">espnet2.gan_codec.shared.loss.freq_loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-decoder-seanet-1">espnet2.gan_codec.shared.decoder.seanet</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-decoder-init-1">espnet2.gan_codec.shared.decoder.__init__</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-decoder-seanet-2d-1">espnet2.gan_codec.shared.decoder.seanet_2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-quantizer-init-1">espnet2.gan_codec.shared.quantizer.__init__</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-quantizer-residual-vq-1">espnet2.gan_codec.shared.quantizer.residual_vq</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-quantizer-modules-init-1">espnet2.gan_codec.shared.quantizer.modules.__init__</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-quantizer-modules-distrib-1">espnet2.gan_codec.shared.quantizer.modules.distrib</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-quantizer-modules-core-vq-1">espnet2.gan_codec.shared.quantizer.modules.core_vq</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-encoder-seanet-1">espnet2.gan_codec.shared.encoder.seanet</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-encoder-snake-activation-1">espnet2.gan_codec.shared.encoder.snake_activation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-encoder-init-1">espnet2.gan_codec.shared.encoder.__init__</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-shared-encoder-seanet-2d-1">espnet2.gan_codec.shared.encoder.seanet_2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-funcodec-init-1">espnet2.gan_codec.funcodec.__init__</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-funcodec-funcodec-1">espnet2.gan_codec.funcodec.funcodec</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-soundstream-init-1">espnet2.gan_codec.soundstream.__init__</a></li>
<li class="toctree-l2"><a class="reference internal" href="#espnet2-gan-codec-soundstream-soundstream-1">espnet2.gan_codec.soundstream.soundstream</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.diar.html">espnet2.diar package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.hubert.html">espnet2.hubert package</a></li>
<li class="toctree-l1"><a class="reference internal" href="espnet2.fst.html">espnet2.fst package</a></li>
</ul>
<p><span class="caption-text">Tool Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../apis/espnet_bin.html">core tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apis/espnet2_bin.html">core tools (espnet2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apis/utils_py.html">python utility tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apis/utils_sh.html">bash utility tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ESPnet</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">espnet2.gan_codec package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_gen/espnet2.gan_codec.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="espnet2-gan-codec-package">
<h1>espnet2.gan_codec package<a class="headerlink" href="#espnet2-gan-codec-package" title="Permalink to this headline">¶</a></h1>
<section id="espnet2-gan-codec-init-1">
<span id="espnet2-gan-codec-init"></span><h2>espnet2.gan_codec.__init__<a class="headerlink" href="#espnet2-gan-codec-init-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.__init__"></span></section>
<section id="espnet2-gan-codec-espnet-model-1">
<span id="espnet2-gan-codec-espnet-model"></span><h2>espnet2.gan_codec.espnet_model<a class="headerlink" href="#espnet2-gan-codec-espnet-model-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.espnet_model"></span><p>GAN-based neural codec ESPnet model.</p>
<dl class="class">
<dt id="espnet2.gan_codec.espnet_model.ESPnetGANCodecModel">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.espnet_model.</code><code class="sig-name descname">ESPnetGANCodecModel</code><span class="sig-paren">(</span><em class="sig-param">codec: espnet2.gan_codec.abs_gan_codec.AbsGANCodec</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/espnet_model.html#ESPnetGANCodecModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.espnet_model.ESPnetGANCodecModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="espnet2.train.html#espnet2.train.abs_gan_espnet_model.AbsGANESPnetModel" title="espnet2.train.abs_gan_espnet_model.AbsGANESPnetModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">espnet2.train.abs_gan_espnet_model.AbsGANESPnetModel</span></code></a></p>
<p>ESPnet model for GAN-based neural codec task.</p>
<p>Initialize ESPnetGANCodecModel module.</p>
<dl class="method">
<dt id="espnet2.gan_codec.espnet_model.ESPnetGANCodecModel.collect_feats">
<code class="sig-name descname">collect_feats</code><span class="sig-paren">(</span><em class="sig-param">audio: torch.Tensor</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; Dict[str, torch.Tensor]<a class="reference internal" href="../_modules/espnet2/gan_codec/espnet_model.html#ESPnetGANCodecModel.collect_feats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.espnet_model.ESPnetGANCodecModel.collect_feats" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate features and return them as a dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>audio</strong> (<em>Tensor</em>) – Audio waveform tensor (B, T_wav).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict of features.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.espnet_model.ESPnetGANCodecModel.decode">
<code class="sig-name descname">decode</code><span class="sig-paren">(</span><em class="sig-param">codes: torch.Tensor</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/espnet_model.html#ESPnetGANCodecModel.decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.espnet_model.ESPnetGANCodecModel.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Codec Decoding Process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>codes</strong> (<em>Tensor</em>) – codec tokens [N_stream, B, T]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated waveform (B, 1, n_sample)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.espnet_model.ESPnetGANCodecModel.decode_continuous">
<code class="sig-name descname">decode_continuous</code><span class="sig-paren">(</span><em class="sig-param">z: torch.Tensor</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/espnet_model.html#ESPnetGANCodecModel.decode_continuous"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.espnet_model.ESPnetGANCodecModel.decode_continuous" title="Permalink to this definition">¶</a></dt>
<dd><p>Codec Decoding Process without dequntization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>z</strong> (<em>Tensor</em>) – continuous codec representation (B, D, T)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated waveform (B, 1, n_sample)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.espnet_model.ESPnetGANCodecModel.encode">
<code class="sig-name descname">encode</code><span class="sig-paren">(</span><em class="sig-param">audio: torch.Tensor</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/espnet_model.html#ESPnetGANCodecModel.encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.espnet_model.ESPnetGANCodecModel.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Codec Encoding Process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>audio</strong> (<em>Tensor</em>) – Audio waveform tensor
(B, 1, T_wav) or (B, T_wav) or (T_wav)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated codecs (N_stream, B, T)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.espnet_model.ESPnetGANCodecModel.encode_continuous">
<code class="sig-name descname">encode_continuous</code><span class="sig-paren">(</span><em class="sig-param">audio</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/espnet_model.html#ESPnetGANCodecModel.encode_continuous"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.espnet_model.ESPnetGANCodecModel.encode_continuous" title="Permalink to this definition">¶</a></dt>
<dd><p>Codec Encoding Process without quantization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>audio</strong> (<em>Tensor</em>) – Audio waveform tensor:
(B, 1, T_wav) or (B, T_wav) or (T_wav)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated codes (B, D, T)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.espnet_model.ESPnetGANCodecModel.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">audio: torch.Tensor</em>, <em class="sig-param">forward_generator: bool = True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; Dict[str, Any]<a class="reference internal" href="../_modules/espnet2/gan_codec/espnet_model.html#ESPnetGANCodecModel.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.espnet_model.ESPnetGANCodecModel.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Return generator or discriminator loss with dict format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>audio</strong> (<em>Tensor</em>) – Audio waveform tensor (B, T_wav).</p></li>
<li><p><strong>forward_generator</strong> (<em>bool</em>) – Whether to forward generator.</p></li>
<li><p><strong>kwargs</strong> – “utt_id” is among the input.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>loss (Tensor): Loss scalar tensor.</p></li>
<li><p>stats (Dict[str, float]): Statistics to be monitored.</p></li>
<li><p>weight (Tensor): Weight tensor to summarize losses.</p></li>
<li><p>optim_idx (int): Optimizer index (0 for G and 1 for D).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.espnet_model.ESPnetGANCodecModel.meta_info">
<code class="sig-name descname">meta_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Dict[str, Any]<a class="reference internal" href="../_modules/espnet2/gan_codec/espnet_model.html#ESPnetGANCodecModel.meta_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.espnet_model.ESPnetGANCodecModel.meta_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Return meta information of the codec.</p>
</dd></dl>

</dd></dl>

</section>
<section id="espnet2-gan-codec-abs-gan-codec-1">
<span id="espnet2-gan-codec-abs-gan-codec"></span><h2>espnet2.gan_codec.abs_gan_codec<a class="headerlink" href="#espnet2-gan-codec-abs-gan-codec-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.abs_gan_codec"></span><p>GAN-based Neural Codec abstrast class.</p>
<dl class="class">
<dt id="espnet2.gan_codec.abs_gan_codec.AbsGANCodec">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.abs_gan_codec.</code><code class="sig-name descname">AbsGANCodec</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/abs_gan_codec.html#AbsGANCodec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.abs_gan_codec.AbsGANCodec" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>GAN-based Neural Codec model abstract class.</p>
<p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="method">
<dt id="espnet2.gan_codec.abs_gan_codec.AbsGANCodec.decode">
<em class="property">abstract </em><code class="sig-name descname">decode</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/espnet2/gan_codec/abs_gan_codec.html#AbsGANCodec.decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.abs_gan_codec.AbsGANCodec.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Return decoded waveform from codecs.</p>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.abs_gan_codec.AbsGANCodec.encode">
<em class="property">abstract </em><code class="sig-name descname">encode</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/espnet2/gan_codec/abs_gan_codec.html#AbsGANCodec.encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.abs_gan_codec.AbsGANCodec.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Return encoded codecs from waveform.</p>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.abs_gan_codec.AbsGANCodec.forward">
<em class="property">abstract </em><code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">forward_generator</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; Dict[str, Union[torch.Tensor, Dict[str, torch.Tensor], int]]<a class="reference internal" href="../_modules/espnet2/gan_codec/abs_gan_codec.html#AbsGANCodec.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.abs_gan_codec.AbsGANCodec.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Return generator or discriminator loss.</p>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.abs_gan_codec.AbsGANCodec.meta_info">
<em class="property">abstract </em><code class="sig-name descname">meta_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Dict[str, Any]<a class="reference internal" href="../_modules/espnet2/gan_codec/abs_gan_codec.html#AbsGANCodec.meta_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.abs_gan_codec.AbsGANCodec.meta_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Return meta information of the codec.</p>
</dd></dl>

</dd></dl>

</section>
<section id="espnet2-gan-codec-encodec-init-1">
<span id="espnet2-gan-codec-encodec-init"></span><h2>espnet2.gan_codec.encodec.__init__<a class="headerlink" href="#espnet2-gan-codec-encodec-init-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.encodec.__init__"></span></section>
<section id="espnet2-gan-codec-encodec-encodec-1">
<span id="espnet2-gan-codec-encodec-encodec"></span><h2>espnet2.gan_codec.encodec.encodec<a class="headerlink" href="#espnet2-gan-codec-encodec-encodec-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.encodec.encodec"></span><dl class="class">
<dt id="espnet2.gan_codec.encodec.encodec.Encodec">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.encodec.encodec.</code><code class="sig-name descname">Encodec</code><span class="sig-paren">(</span><em class="sig-param">sampling_rate: int = 24000, generator_params: Dict[str, Any] = {'decoder_final_activation': None, 'decoder_final_activation_params': None, 'decoder_trim_right_ratio': 1.0, 'encdec_activation': 'ELU', 'encdec_activation_params': {'alpha': 1.0}, 'encdec_causal': False, 'encdec_channels': 1, 'encdec_compress': 2, 'encdec_dilation_base': 2, 'encdec_kernel_size': 7, 'encdec_last_kernel_size': 7, 'encdec_lstm': 2, 'encdec_n_filters': 32, 'encdec_n_residual_layers': 1, 'encdec_norm': 'weight_norm', 'encdec_norm_params': {}, 'encdec_pad_mode': 'reflect', 'encdec_ratios': [8, 5, 4, 2], 'encdec_residual_kernel_size': 7, 'encdec_true_skip': False, 'hidden_dim': 128, 'quantizer_bins': 1024, 'quantizer_decay': 0.99, 'quantizer_kmeans_init': True, 'quantizer_kmeans_iters': 50, 'quantizer_n_q': 8, 'quantizer_target_bandwidth': [7.5, 15], 'quantizer_threshold_ema_dead_code': 2}, discriminator_params: Dict[str, Any] = {'activation': 'LeakyReLU', 'activation_params': {'negative_slope': 0.3}, 'filters': 32, 'hop_lengths': [256, 512, 128, 64, 32], 'in_channels': 1, 'n_ffts': [1024, 2048, 512, 256, 128], 'norm': 'weight_norm', 'out_channels': 1, 'sep_channels': False, 'win_lengths': [1024, 2048, 512, 256, 128]}, generator_adv_loss_params: Dict[str, Any] = {'average_by_discriminators': False, 'loss_type': 'mse'}, discriminator_adv_loss_params: Dict[str, Any] = {'average_by_discriminators': False, 'loss_type': 'mse'}, use_feat_match_loss: bool = True, feat_match_loss_params: Dict[str, Any] = {'average_by_discriminators': False, 'average_by_layers': False, 'include_final_outputs': True}, use_mel_loss: bool = True, mel_loss_params: Dict[str, Any] = {'fmax': None, 'fmin': 0, 'fs': 24000, 'log_base': None, 'n_mels': 80, 'range_end': 11, 'range_start': 6, 'window': 'hann'}, use_dual_decoder: bool = True, lambda_quantization: float = 1.0, lambda_reconstruct: float = 1.0, lambda_commit: float = 1.0, lambda_adv: float = 1.0, lambda_feat_match: float = 2.0, lambda_mel: float = 45.0, cache_generator_outputs: bool = False, use_loss_balancer: bool = False, balance_ema_decay: float = 0.99</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/encodec/encodec.html#Encodec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.encodec.encodec.Encodec" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#espnet2.gan_codec.soundstream.soundstream.SoundStream" title="espnet2.gan_codec.soundstream.soundstream.SoundStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">espnet2.gan_codec.soundstream.soundstream.SoundStream</span></code></a></p>
<p>Encodec Model: <a class="reference external" href="https://arxiv.org/abs/2210.13438">https://arxiv.org/abs/2210.13438</a>
The key differences between this and SoundStream are the discriminator
and loss balancer. Check SoundStream model for many details</p>
</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.encodec.encodec.EncodecDiscriminator">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.encodec.encodec.</code><code class="sig-name descname">EncodecDiscriminator</code><span class="sig-paren">(</span><em class="sig-param">msstft_discriminator_params: Dict[str, Any] = {'activation': 'LeakyReLU', 'activation_params': {'negative_slope: 0.3'}, 'filters': 32, 'hop_lengths': [256, 512, 128, 64, 32], 'in_channels': 1, 'n_fft': [1024, 2048, 512, 256, 128], 'norm': 'weight_norm', 'out_channels': 1, 'win_lengths': [1024, 2048, 512, 256, 128]}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/encodec/encodec.html#EncodecDiscriminator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.encodec.encodec.EncodecDiscriminator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Encodec Discriminator with only Multi-Scale STFT discriminator module</p>
<p>Initialize Encodec Discriminator module.</p>
<dl>
<dt>Args: msstft_discriminator_params (Dict[str, Any]) with following arguments:</dt><dd><p>in_channels (int): Number of input channels.
out_channels (int): Number of output channels.
filters (int): Number of filters in convolutions.
norm (str): normalization choice of Convolutional layers
n_ffts (Sequence[int]): Size of FFT for each scale.
hop_lengths (Sequence[int]): Length of hop between STFT windows for</p>
<blockquote>
<div><p>each scale.</p>
</div></blockquote>
<p>win_lengths (Sequence[int]): Window size for each scale.
activation (str): activation function choice of convolutional layer
activation_params (Dict[str, Any]): parameters for activation function)</p>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.encodec.encodec.EncodecDiscriminator.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em><span class="sig-paren">)</span> &#x2192; List[List[torch.Tensor]]<a class="reference internal" href="../_modules/espnet2/gan_codec/encodec/encodec.html#EncodecDiscriminator.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.encodec.encodec.EncodecDiscriminator.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate forward propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Input noise signal (B, 1, T).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>List of list of each discriminator outputs,</dt><dd><p>which consists of each layer output tensors. Only one
discriminator here, but still make it as List of List for
consistency.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[Tensor]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="espnet2-gan-codec-dac-dac-1">
<span id="espnet2-gan-codec-dac-dac"></span><h2>espnet2.gan_codec.dac.dac<a class="headerlink" href="#espnet2-gan-codec-dac-dac-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.dac.dac"></span><p>DAC Modules.</p>
<dl class="class">
<dt id="espnet2.gan_codec.dac.dac.DAC">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.dac.dac.</code><code class="sig-name descname">DAC</code><span class="sig-paren">(</span><em class="sig-param">sampling_rate: int = 24000, generator_params: Dict[str, Any] = {'decoder_final_activation': None, 'decoder_final_activation_params': None, 'decoder_trim_right_ratio': 1.0, 'encdec_activation': 'Snake', 'encdec_activation_params': {}, 'encdec_causal': False, 'encdec_channels': 1, 'encdec_compress': 2, 'encdec_dilation_base': 2, 'encdec_kernel_size': 7, 'encdec_last_kernel_size': 7, 'encdec_lstm': 2, 'encdec_n_filters': 32, 'encdec_n_residual_layers': 1, 'encdec_norm': 'weight_norm', 'encdec_norm_params': {}, 'encdec_pad_mode': 'reflect', 'encdec_ratios': [8, 5, 4, 2], 'encdec_residual_kernel_size': 7, 'encdec_true_skip': False, 'hidden_dim': 128, 'quantizer_bins': 1024, 'quantizer_decay': 0.99, 'quantizer_dropout': True, 'quantizer_kmeans_init': True, 'quantizer_kmeans_iters': 50, 'quantizer_n_q': 8, 'quantizer_target_bandwidth': [7.5, 15], 'quantizer_threshold_ema_dead_code': 2}, discriminator_params: Dict[str, Any] = {'complexstft_discriminator_params': {'chan_mults': (1, 2, 4, 4, 8, 8), 'channels': 32, 'hop_length': 256, 'in_channels': 1, 'logits_abs': True, 'n_fft': 1024, 'stft_normalized': False, 'strides': ((1, 2), (2, 2), (1, 2), (2, 2), (1, 2), (2, 2)), 'win_length': 1024}, 'scale_discriminator_params': {'bias': True, 'channels': 128, 'downsample_scales': [2, 2, 4, 4, 1], 'in_channels': 1, 'kernel_sizes': [15, 41, 5, 3], 'max_downsample_channels': 1024, 'max_groups': 16, 'nonlinear_activation': 'LeakyReLU', 'nonlinear_activation_params': {'negative_slope': 0.1}, 'out_channels': 1}, 'scale_downsample_pooling': 'AvgPool1d', 'scale_downsample_pooling_params': {'kernel_size': 4, 'padding': 2, 'stride': 2}, 'scale_follow_official_norm': False, 'scales': 3}, generator_adv_loss_params: Dict[str, Any] = {'average_by_discriminators': False, 'loss_type': 'mse'}, discriminator_adv_loss_params: Dict[str, Any] = {'average_by_discriminators': False, 'loss_type': 'mse'}, use_feat_match_loss: bool = True, feat_match_loss_params: Dict[str, Any] = {'average_by_discriminators': False, 'average_by_layers': False, 'include_final_outputs': True}, use_mel_loss: bool = True, mel_loss_params: Dict[str, Any] = {'fmax': None, 'fmin': 0, 'fs': 24000, 'log_base': None, 'n_mels': 80, 'range_end': 11, 'range_start': 6, 'window': 'hann'}, use_dual_decoder: bool = True, lambda_quantization: float = 1.0, lambda_reconstruct: float = 1.0, lambda_commit: float = 1.0, lambda_adv: float = 1.0, lambda_feat_match: float = 2.0, lambda_mel: float = 45.0, cache_generator_outputs: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/dac/dac.html#DAC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.dac.dac.DAC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#espnet2.gan_codec.abs_gan_codec.AbsGANCodec" title="espnet2.gan_codec.abs_gan_codec.AbsGANCodec"><code class="xref py py-class docutils literal notranslate"><span class="pre">espnet2.gan_codec.abs_gan_codec.AbsGANCodec</span></code></a></p>
<p>“DAC model.</p>
<p>Intialize DAC model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>TODO</strong> (<em>jiatong</em>) – </p>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.dac.dac.DAC.decode">
<code class="sig-name descname">decode</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/espnet2/gan_codec/dac/dac.html#DAC.decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.dac.dac.DAC.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Run encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Input codes (T_code, N_stream).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated waveform (T_wav,).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.dac.dac.DAC.encode">
<code class="sig-name descname">encode</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/espnet2/gan_codec/dac/dac.html#DAC.encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.dac.dac.DAC.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Run encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Input audio (T_wav,).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated codes (T_code, N_stream).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.dac.dac.DAC.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">audio: torch.Tensor</em>, <em class="sig-param">forward_generator: bool = True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; Dict[str, Any]<a class="reference internal" href="../_modules/espnet2/gan_codec/dac/dac.html#DAC.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.dac.dac.DAC.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform generator forward.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>audio</strong> (<em>Tensor</em>) – Audio waveform tensor (B, T_wav).</p></li>
<li><p><strong>forward_generator</strong> (<em>bool</em>) – Whether to forward generator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>loss (Tensor): Loss scalar tensor.</p></li>
<li><p>stats (Dict[str, float]): Statistics to be monitored.</p></li>
<li><p>weight (Tensor): Weight tensor to summarize losses.</p></li>
<li><p>optim_idx (int): Optimizer index (0 for G and 1 for D).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.dac.dac.DAC.inference">
<code class="sig-name descname">inference</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; Dict[str, torch.Tensor]<a class="reference internal" href="../_modules/espnet2/gan_codec/dac/dac.html#DAC.inference"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.dac.dac.DAC.inference" title="Permalink to this definition">¶</a></dt>
<dd><p>Run inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Input audio (T_wav,).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>wav (Tensor): Generated waveform tensor (T_wav,).</p></li>
<li><p>codec (Tensor): Generated neural codec (T_code, N_stream).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.dac.dac.DAC.meta_info">
<code class="sig-name descname">meta_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Dict[str, Any]<a class="reference internal" href="../_modules/espnet2/gan_codec/dac/dac.html#DAC.meta_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.dac.dac.DAC.meta_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Return meta information of the codec.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.dac.dac.DACDiscriminator">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.dac.dac.</code><code class="sig-name descname">DACDiscriminator</code><span class="sig-paren">(</span><em class="sig-param">scales: int = 3, scale_downsample_pooling: str = 'AvgPool1d', scale_downsample_pooling_params: Dict[str, Any] = {'kernel_size': 4, 'padding': 2, 'stride': 2}, scale_discriminator_params: Dict[str, Any] = {'bias': True, 'channels': 128, 'downsample_scales': [2, 2, 4, 4, 1], 'in_channels': 1, 'kernel_sizes': [15, 41, 5, 3], 'max_downsample_channels': 1024, 'max_groups': 16, 'nonlinear_activation': 'LeakyReLU', 'nonlinear_activation_params': {'negative_slope': 0.1}, 'out_channels': 1}, msmpmb_discriminator_params: Dict[str, Any] = {'band_discriminator_params': {'bands': [(0.0, 0.1), (0.1, 0.25), (0.25, 0.5), (0.5, 0.75), (0.75, 1.0)], 'channel': 32, 'hop_factor': 0.25, 'sample_rate': 24000}, 'fft_sizes': [2048, 1024, 512], 'period_discriminator_params': {'bias': True, 'channels': 32, 'downsample_scales': [3, 3, 3, 3, 1], 'in_channels': 1, 'kernel_sizes': [5, 3], 'max_downsample_channels': 1024, 'nonlinear_activation': 'LeakyReLU', 'nonlinear_activation_params': {'negative_slope': 0.1}, 'out_channels': 1, 'use_spectral_norm': False, 'use_weight_norm': True}, 'periods': [2, 3, 5, 7, 11], 'rates': [], 'sample_rate': 24000}, scale_follow_official_norm: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/dac/dac.html#DACDiscriminator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.dac.dac.DACDiscriminator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>DAC discriminator module.</p>
<p>Initialize DAC Discriminator module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scales</strong> (<em>int</em>) – Number of multi-scales.</p></li>
<li><p><strong>sclae_downsample_pooling</strong> (<em>str</em>) – Pooling module name for downsampling of the
inputs.</p></li>
<li><p><strong>scale_downsample_pooling_params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Parameters for the above
pooling module.</p></li>
<li><p><strong>scale_discriminator_params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Parameters for hifi-gan  scale
discriminator module.</p></li>
<li><p><strong>scale_follow_official_norm</strong> (<em>bool</em>) – Whether to follow the norm setting of the
official implementaion. The first discriminator uses spectral norm
and the other discriminators use weight norm.</p></li>
<li><p><strong>complexstft_discriminator_params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Parameters for the
complex stft discriminator module.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.dac.dac.DACDiscriminator.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em><span class="sig-paren">)</span> &#x2192; List[List[torch.Tensor]]<a class="reference internal" href="../_modules/espnet2/gan_codec/dac/dac.html#DACDiscriminator.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.dac.dac.DACDiscriminator.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate forward propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Input noise signal (B, 1, T).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>List of list of each discriminator outputs,</dt><dd><p>which consists of each layer output tensors. Multi scale and
multi period ones are concatenated.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[Tensor]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.dac.dac.DACGenerator">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.dac.dac.</code><code class="sig-name descname">DACGenerator</code><span class="sig-paren">(</span><em class="sig-param">sample_rate: int = 24000, hidden_dim: int = 128, codebook_dim: int = 8, encdec_channels: int = 1, encdec_n_filters: int = 32, encdec_n_residual_layers: int = 1, encdec_ratios: List[int] = [8, 5, 4, 2], encdec_activation: str = 'Snake', encdec_activation_params: Dict[str, Any] = {}, encdec_norm: str = 'weight_norm', encdec_norm_params: Dict[str, Any] = {}, encdec_kernel_size: int = 7, encdec_residual_kernel_size: int = 7, encdec_last_kernel_size: int = 7, encdec_dilation_base: int = 2, encdec_causal: bool = False, encdec_pad_mode: str = 'reflect', encdec_true_skip: bool = False, encdec_compress: int = 2, encdec_lstm: int = 2, decoder_trim_right_ratio: float = 1.0, decoder_final_activation: Optional[str] = None, decoder_final_activation_params: Optional[dict] = None, quantizer_n_q: int = 8, quantizer_bins: int = 1024, quantizer_decay: float = 0.99, quantizer_kmeans_init: bool = True, quantizer_kmeans_iters: int = 50, quantizer_threshold_ema_dead_code: int = 2, quantizer_target_bandwidth: List[float] = [7.5, 15], quantizer_dropout: bool = True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/dac/dac.html#DACGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.dac.dac.DACGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>DAC generator module.</p>
<p>Initialize DAC Generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>TODO</strong> (<em>jiatong</em>) – </p>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.dac.dac.DACGenerator.decode">
<code class="sig-name descname">decode</code><span class="sig-paren">(</span><em class="sig-param">codes: torch.Tensor</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/dac/dac.html#DACGenerator.decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.dac.dac.DACGenerator.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>DAC codec decoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>codecs</strong> (<em>torch.Tensor</em>) – neural codecs in shape ().</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>resynthesized audio.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.dac.dac.DACGenerator.encode">
<code class="sig-name descname">encode</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">target_bw: Optional[float] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/dac/dac.html#DACGenerator.encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.dac.dac.DACGenerator.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>DAC codec encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input tensor of shape (B, 1, T).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>neural codecs in shape ().</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.dac.dac.DACGenerator.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">use_dual_decoder: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/dac/dac.html#DACGenerator.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.dac.dac.DACGenerator.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>DAC forward propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – Input tensor of shape (B, 1, T).</p></li>
<li><p><strong>use_dual_decoder</strong> (<em>bool</em>) – Whether to use dual decoder for encoder out</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>resynthesized audio.
torch.Tensor: commitment loss.
torch.Tensor: quantization loss
torch.Tensor: resynthesized audio from encoder.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="espnet2-gan-codec-dac-init-1">
<span id="espnet2-gan-codec-dac-init"></span><h2>espnet2.gan_codec.dac.__init__<a class="headerlink" href="#espnet2-gan-codec-dac-init-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.dac.__init__"></span></section>
<section id="espnet2-gan-codec-shared-init-1">
<span id="espnet2-gan-codec-shared-init"></span><h2>espnet2.gan_codec.shared.__init__<a class="headerlink" href="#espnet2-gan-codec-shared-init-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.__init__"></span></section>
<section id="espnet2-gan-codec-shared-discriminator-msstft-conv-1">
<span id="espnet2-gan-codec-shared-discriminator-msstft-conv"></span><h2>espnet2.gan_codec.shared.discriminator.msstft_conv<a class="headerlink" href="#espnet2-gan-codec-shared-discriminator-msstft-conv-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.discriminator.msstft_conv"></span><dl class="class">
<dt id="espnet2.gan_codec.shared.discriminator.msstft_conv.NormConv2d">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.discriminator.msstft_conv.</code><code class="sig-name descname">NormConv2d</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">norm: str = 'none'</em>, <em class="sig-param">norm_kwargs: Dict[str</em>, <em class="sig-param">Any] = {}</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msstft_conv.html#NormConv2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msstft_conv.NormConv2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Wrapper around Conv2d and normalization applied to this conv
to provide a uniform interface across normalization approaches.</p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.discriminator.msstft_conv.NormConv2d.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msstft_conv.html#NormConv2d.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msstft_conv.NormConv2d.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.discriminator.msstft_conv.NormConvTranspose2d">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.discriminator.msstft_conv.</code><code class="sig-name descname">NormConvTranspose2d</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">norm: str = 'none'</em>, <em class="sig-param">norm_kwargs: Dict[str</em>, <em class="sig-param">Any] = {}</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msstft_conv.html#NormConvTranspose2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msstft_conv.NormConvTranspose2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Wrapper around ConvTranspose2d and normalization applied to this conv
to provide a uniform interface across normalization approaches.</p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.discriminator.msstft_conv.NormConvTranspose2d.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msstft_conv.html#NormConvTranspose2d.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msstft_conv.NormConvTranspose2d.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

</section>
<section id="espnet2-gan-codec-shared-discriminator-init-1">
<span id="espnet2-gan-codec-shared-discriminator-init"></span><h2>espnet2.gan_codec.shared.discriminator.__init__<a class="headerlink" href="#espnet2-gan-codec-shared-discriminator-init-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.discriminator.__init__"></span></section>
<section id="espnet2-gan-codec-shared-discriminator-msstft-discriminator-1">
<span id="espnet2-gan-codec-shared-discriminator-msstft-discriminator"></span><h2>espnet2.gan_codec.shared.discriminator.msstft_discriminator<a class="headerlink" href="#espnet2-gan-codec-shared-discriminator-msstft-discriminator-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.discriminator.msstft_discriminator"></span><dl class="class">
<dt id="espnet2.gan_codec.shared.discriminator.msstft_discriminator.DiscriminatorSTFT">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.discriminator.msstft_discriminator.</code><code class="sig-name descname">DiscriminatorSTFT</code><span class="sig-paren">(</span><em class="sig-param">filters: int, in_channels: int = 1, out_channels: int = 1, n_fft: int = 1024, hop_length: int = 256, win_length: int = 1024, max_filters: int = 1024, filters_scale: int = 1, kernel_size: Tuple[int, int] = (3, 9), dilations: List = [1, 2, 4], stride: Tuple[int, int] = (1, 2), normalized: bool = True, norm: str = 'weight_norm', activation: str = 'LeakyReLU', activation_params: dict = {'negative_slope': 0.2}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msstft_discriminator.html#DiscriminatorSTFT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msstft_discriminator.DiscriminatorSTFT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>STFT sub-discriminator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filters</strong> (<em>int</em>) – Number of filters in convolutions.</p></li>
<li><p><strong>in_channels</strong> (<em>int</em>) – Number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<em>int</em>) – Number of output channels.</p></li>
<li><p><strong>n_fft</strong> (<em>int</em>) – Size of FFT for each scale.</p></li>
<li><p><strong>hop_length</strong> (<em>int</em>) – Length of hop between STFT windows for each scale.</p></li>
<li><p><strong>kernel_size</strong> (<em>tuple of int</em>) – Inner Conv2d kernel sizes.</p></li>
<li><p><strong>stride</strong> (<em>tuple of int</em>) – Inner Conv2d strides.</p></li>
<li><p><strong>dilations</strong> (<em>list of int</em>) – Inner Conv2d dilation on the time dimension.</p></li>
<li><p><strong>win_length</strong> (<em>int</em>) – Window size for each scale.</p></li>
<li><p><strong>normalized</strong> (<em>bool</em>) – Whether to normalize by magnitude after stft.</p></li>
<li><p><strong>norm</strong> (<em>str</em>) – Normalization method.</p></li>
<li><p><strong>activation</strong> (<em>str</em>) – Activation function.</p></li>
<li><p><strong>activation_params</strong> (<em>dict</em>) – Parameters to provide to the activation function.</p></li>
<li><p><strong>growth</strong> (<em>int</em>) – Growth factor for the filters.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.shared.discriminator.msstft_discriminator.DiscriminatorSTFT.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msstft_discriminator.html#DiscriminatorSTFT.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msstft_discriminator.DiscriminatorSTFT.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.discriminator.msstft_discriminator.MultiDiscriminator">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.discriminator.msstft_discriminator.</code><code class="sig-name descname">MultiDiscriminator</code><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msstft_discriminator.html#MultiDiscriminator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msstft_discriminator.MultiDiscriminator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Base implementation for discriminators composed of sub-discriminators
acting at different scales.</p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.discriminator.msstft_discriminator.MultiDiscriminator.forward">
<em class="property">abstract </em><code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msstft_discriminator.html#MultiDiscriminator.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msstft_discriminator.MultiDiscriminator.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.discriminator.msstft_discriminator.MultiDiscriminator.num_discriminators">
<em class="property">abstract property </em><code class="sig-name descname">num_discriminators</code><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msstft_discriminator.MultiDiscriminator.num_discriminators" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of discriminators.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.discriminator.msstft_discriminator.MultiScaleSTFTDiscriminator">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.discriminator.msstft_discriminator.</code><code class="sig-name descname">MultiScaleSTFTDiscriminator</code><span class="sig-paren">(</span><em class="sig-param">filters: int, in_channels: int = 1, out_channels: int = 1, sep_channels: bool = False, n_ffts: List[int] = [1024, 2048, 512], hop_lengths: List[int] = [256, 512, 128], win_lengths: List[int] = [1024, 2048, 512], **kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msstft_discriminator.html#MultiScaleSTFTDiscriminator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msstft_discriminator.MultiScaleSTFTDiscriminator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#espnet2.gan_codec.shared.discriminator.msstft_discriminator.MultiDiscriminator" title="espnet2.gan_codec.shared.discriminator.msstft_discriminator.MultiDiscriminator"><code class="xref py py-class docutils literal notranslate"><span class="pre">espnet2.gan_codec.shared.discriminator.msstft_discriminator.MultiDiscriminator</span></code></a></p>
<p>Multi-Scale STFT (MS-STFT) discriminator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filters</strong> (<em>int</em>) – Number of filters in convolutions.</p></li>
<li><p><strong>in_channels</strong> (<em>int</em>) – Number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<em>int</em>) – Number of output channels.</p></li>
<li><p><strong>sep_channels</strong> (<em>bool</em>) – Separate channels to distinct samples for stereo support.</p></li>
<li><p><strong>n_ffts</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Size of FFT for each scale.</p></li>
<li><p><strong>hop_lengths</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Length of hop between STFT windows for each scale.</p></li>
<li><p><strong>win_lengths</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Window size for each scale.</p></li>
<li><p><strong>**kwargs</strong> – Additional args for STFTDiscriminator.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.shared.discriminator.msstft_discriminator.MultiScaleSTFTDiscriminator.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msstft_discriminator.html#MultiScaleSTFTDiscriminator.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msstft_discriminator.MultiScaleSTFTDiscriminator.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.discriminator.msstft_discriminator.MultiScaleSTFTDiscriminator.num_discriminators">
<em class="property">property </em><code class="sig-name descname">num_discriminators</code><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msstft_discriminator.MultiScaleSTFTDiscriminator.num_discriminators" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of discriminators.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.discriminator.msstft_discriminator.get_2d_padding">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.discriminator.msstft_discriminator.</code><code class="sig-name descname">get_2d_padding</code><span class="sig-paren">(</span><em class="sig-param">kernel_size: Tuple[int, int], dilation: Tuple[int, int] = (1, 1)</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msstft_discriminator.html#get_2d_padding"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msstft_discriminator.get_2d_padding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="espnet2-gan-codec-shared-discriminator-msmpmb-discriminator-1">
<span id="espnet2-gan-codec-shared-discriminator-msmpmb-discriminator"></span><h2>espnet2.gan_codec.shared.discriminator.msmpmb_discriminator<a class="headerlink" href="#espnet2-gan-codec-shared-discriminator-msmpmb-discriminator-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.discriminator.msmpmb_discriminator"></span><dl class="class">
<dt id="espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.MultiBandDiscriminator">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.</code><code class="sig-name descname">MultiBandDiscriminator</code><span class="sig-paren">(</span><em class="sig-param">window_length: int, hop_factor: float = 0.25, sample_rate: int = 44100, bands: list = [(0.0, 0.1), (0.1, 0.25), (0.25, 0.5), (0.5, 0.75), (0.75, 1.0)], channel: int = 32</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msmpmb_discriminator.html#MultiBandDiscriminator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.MultiBandDiscriminator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Complex multi-band spectrogram discriminator.
:param window_length: Window length of STFT.
:type window_length: int
:param hop_factor: Hop factor of the STFT, defaults to <code class="docutils literal notranslate"><span class="pre">0.25</span> <span class="pre">*</span> <span class="pre">window_length</span></code>.
:type hop_factor: float, optional
:param sample_rate: Sampling rate of audio in Hz, by default 44100
:type sample_rate: int, optional
:param bands: Bands to run discriminator over.
:type bands: list, optional</p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.MultiBandDiscriminator.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msmpmb_discriminator.html#MultiBandDiscriminator.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.MultiBandDiscriminator.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.MultiBandDiscriminator.spectrogram">
<code class="sig-name descname">spectrogram</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msmpmb_discriminator.html#MultiBandDiscriminator.spectrogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.MultiBandDiscriminator.spectrogram" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.MultiScaleDiscriminator">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.</code><code class="sig-name descname">MultiScaleDiscriminator</code><span class="sig-paren">(</span><em class="sig-param">rate: int = 1</em>, <em class="sig-param">sample_rate: int = 44100</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msmpmb_discriminator.html#MultiScaleDiscriminator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.MultiScaleDiscriminator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.MultiScaleDiscriminator.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msmpmb_discriminator.html#MultiScaleDiscriminator.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.MultiScaleDiscriminator.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.MultiScaleMultiPeriodMultiBandDiscriminator">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.</code><code class="sig-name descname">MultiScaleMultiPeriodMultiBandDiscriminator</code><span class="sig-paren">(</span><em class="sig-param">rates: list = [], fft_sizes: list = [2048, 1024, 512], sample_rate: int = 44100, periods: List[int] = [2, 3, 5, 7, 11], period_discriminator_params: Dict[str, Any] = {'bias': True, 'channels': 32, 'downsample_scales': [3, 3, 3, 3, 1], 'in_channels': 1, 'kernel_sizes': [5, 3], 'max_downsample_channels': 1024, 'nonlinear_activation': 'LeakyReLU', 'nonlinear_activation_params': {'negative_slope': 0.1}, 'out_channels': 1, 'use_spectral_norm': False, 'use_weight_norm': True}, band_discriminator_params: Dict[str, Any] = {'bands': [(0.0, 0.1), (0.1, 0.25), (0.25, 0.5), (0.5, 0.75), (0.75, 1.0)], 'channel': 32, 'hop_factor': 0.25, 'sample_rate': 24000}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msmpmb_discriminator.html#MultiScaleMultiPeriodMultiBandDiscriminator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.MultiScaleMultiPeriodMultiBandDiscriminator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Discriminator that combines multiple discriminators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rates</strong> (<em>list</em><em>, </em><em>optional</em>) – sampling rates (in Hz) to run MSD at, by default []
If empty, MSD is not used.</p></li>
<li><p><strong>periods</strong> (<em>list</em><em>, </em><em>optional</em>) – periods (of samples) to run MPD at, by default [2, 3, 5, 7, 11]</p></li>
<li><p><strong>fft_sizes</strong> (<em>list</em><em>, </em><em>optional</em>) – Window sizes of the FFT to run MRD at, by default [2048, 1024, 512]</p></li>
<li><p><strong>sample_rate</strong> (<em>int</em><em>, </em><em>optional</em>) – Sampling rate of audio in Hz, by default 44100</p></li>
<li><p><strong>bands</strong> (<em>list</em><em>, </em><em>optional</em>) – Bands to run MRD at, by default <cite>BANDS</cite></p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.MultiScaleMultiPeriodMultiBandDiscriminator.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msmpmb_discriminator.html#MultiScaleMultiPeriodMultiBandDiscriminator.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.MultiScaleMultiPeriodMultiBandDiscriminator.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.MultiScaleMultiPeriodMultiBandDiscriminator.preprocess">
<code class="sig-name descname">preprocess</code><span class="sig-paren">(</span><em class="sig-param">y</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msmpmb_discriminator.html#MultiScaleMultiPeriodMultiBandDiscriminator.preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.MultiScaleMultiPeriodMultiBandDiscriminator.preprocess" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.WNConv1d">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.</code><code class="sig-name descname">WNConv1d</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msmpmb_discriminator.html#WNConv1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.WNConv1d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.WNConv2d">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.</code><code class="sig-name descname">WNConv2d</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/msmpmb_discriminator.html#WNConv2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.msmpmb_discriminator.WNConv2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="espnet2-gan-codec-shared-discriminator-stft-discriminator-1">
<span id="espnet2-gan-codec-shared-discriminator-stft-discriminator"></span><h2>espnet2.gan_codec.shared.discriminator.stft_discriminator<a class="headerlink" href="#espnet2-gan-codec-shared-discriminator-stft-discriminator-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.discriminator.stft_discriminator"></span><p>HiFi-GAN Modules.</p>
<p>This code is modified from <a class="reference external" href="https://github.com/kan-bayashi/ParallelWaveGAN">https://github.com/kan-bayashi/ParallelWaveGAN</a>.</p>
<dl class="class">
<dt id="espnet2.gan_codec.shared.discriminator.stft_discriminator.ComplexConv2d">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.discriminator.stft_discriminator.</code><code class="sig-name descname">ComplexConv2d</code><span class="sig-paren">(</span><em class="sig-param">dim</em>, <em class="sig-param">dim_out</em>, <em class="sig-param">kernel_size</em>, <em class="sig-param">stride=1</em>, <em class="sig-param">padding=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/stft_discriminator.html#ComplexConv2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.stft_discriminator.ComplexConv2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>ComplexConv2d module.</p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.discriminator.stft_discriminator.ComplexConv2d.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/stft_discriminator.html#ComplexConv2d.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.stft_discriminator.ComplexConv2d.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.discriminator.stft_discriminator.ComplexSTFTDiscriminator">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.discriminator.stft_discriminator.</code><code class="sig-name descname">ComplexSTFTDiscriminator</code><span class="sig-paren">(</span><em class="sig-param">*, in_channels=1, channels=32, strides=[[1, 2], [2, 2], [1, 2], [2, 2], [1, 2], [2, 2]], chan_mults=[1, 2, 4, 4, 8, 8], n_fft=1024, hop_length=256, win_length=1024, stft_normalized=False, logits_abs=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/stft_discriminator.html#ComplexSTFTDiscriminator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.stft_discriminator.ComplexSTFTDiscriminator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>ComplexSTFT Discriminator used in SoundStream.</p>
<p>Initialize Complex STFT Discriminator used in SoundStream.</p>
<p>Adapted from <a class="reference external" href="https://github.com/alibaba-damo-academy/FunCodec.git">https://github.com/alibaba-damo-academy/FunCodec.git</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<em>int</em>) – Input channel.</p></li>
<li><p><strong>channels</strong> (<em>int</em>) – Output channel.</p></li>
<li><p><strong>strides</strong> (<em>List</em><em>[</em><em>List</em><em>(</em><em>int</em><em>, </em><em>int</em><em>)</em><em>]</em>) – detailed strides in conv2d modules.</p></li>
<li><p><strong>chan_mults</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – Channel multiplers.</p></li>
<li><p><strong>n_fft</strong> (<em>int</em>) – n_fft in the STFT.</p></li>
<li><p><strong>hop_length</strong> (<em>int</em>) – hop_length in the STFT.</p></li>
<li><p><strong>stft_normalized</strong> (<em>bool</em>) – whether to normalize the stft output.</p></li>
<li><p><strong>logits_abs</strong> (<em>bool</em>) – whether to use the absolute number of output logits.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.shared.discriminator.stft_discriminator.ComplexSTFTDiscriminator.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/stft_discriminator.html#ComplexSTFTDiscriminator.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.stft_discriminator.ComplexSTFTDiscriminator.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate forward propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Input signal (B, 1, T).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of list of the discriminator output.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[Tensor]]</p>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p>Paper: <a class="reference external" href="https://arxiv.org/pdf/2107.03312.pdf">https://arxiv.org/pdf/2107.03312.pdf</a>
Implementation: <a class="reference external" href="https://github.com/alibaba-damo-academy/FunCodec.git">https://github.com/alibaba-damo-academy/FunCodec.git</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.discriminator.stft_discriminator.ComplexSTFTResidualUnit">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.discriminator.stft_discriminator.</code><code class="sig-name descname">ComplexSTFTResidualUnit</code><span class="sig-paren">(</span><em class="sig-param">in_channel</em>, <em class="sig-param">out_channel</em>, <em class="sig-param">strides</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/stft_discriminator.html#ComplexSTFTResidualUnit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.stft_discriminator.ComplexSTFTResidualUnit" title="Permalink to this definition">¶</a></dt>
<dd><p>Complex STFT Residual block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channel</strong> (<em>int</em>) – Input channel.</p></li>
<li><p><strong>out_channel</strong> (<em>int</em>) – Output channel.</p></li>
<li><p><strong>strides</strong> (<em>int</em>) – Strides of the whole module.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output nn module with complex conv2ds.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.discriminator.stft_discriminator.ModReLU">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.discriminator.stft_discriminator.</code><code class="sig-name descname">ModReLU</code><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/stft_discriminator.html#ModReLU"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.stft_discriminator.ModReLU" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>ComplexReLU module.</p>
<dl class="simple">
<dt>Reference:</dt><dd><p><a class="reference external" href="https://arxiv.org/abs/1705.09792">https://arxiv.org/abs/1705.09792</a>
<a class="reference external" href="https://github.com/pytorch/pytorch/issues/47052#issuecomment-718948801">https://github.com/pytorch/pytorch/issues/47052#issuecomment-718948801</a></p>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.shared.discriminator.stft_discriminator.ModReLU.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/discriminator/stft_discriminator.html#ModReLU.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.discriminator.stft_discriminator.ModReLU.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

</section>
<section id="espnet2-gan-codec-shared-loss-init-1">
<span id="espnet2-gan-codec-shared-loss-init"></span><h2>espnet2.gan_codec.shared.loss.__init__<a class="headerlink" href="#espnet2-gan-codec-shared-loss-init-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.loss.__init__"></span></section>
<section id="espnet2-gan-codec-shared-loss-loss-balancer-1">
<span id="espnet2-gan-codec-shared-loss-loss-balancer"></span><h2>espnet2.gan_codec.shared.loss.loss_balancer<a class="headerlink" href="#espnet2-gan-codec-shared-loss-loss-balancer-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.loss.loss_balancer"></span><dl class="class">
<dt id="espnet2.gan_codec.shared.loss.loss_balancer.Balancer">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.loss.loss_balancer.</code><code class="sig-name descname">Balancer</code><span class="sig-paren">(</span><em class="sig-param">total_norm: float = 1.0</em>, <em class="sig-param">ema_decay: float = 0.999</em>, <em class="sig-param">per_batch_item: bool = True</em>, <em class="sig-param">epsilon: float = 1e-12</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/loss/loss_balancer.html#Balancer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.loss.loss_balancer.Balancer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.loss.loss_balancer.Balancer.metrics">
<em class="property">property </em><code class="sig-name descname">metrics</code><a class="headerlink" href="#espnet2.gan_codec.shared.loss.loss_balancer.Balancer.metrics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.loss.loss_balancer.EMA">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.loss.loss_balancer.</code><code class="sig-name descname">EMA</code><span class="sig-paren">(</span><em class="sig-param">ema_decay</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/loss/loss_balancer.html#EMA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.loss.loss_balancer.EMA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

</section>
<section id="espnet2-gan-codec-shared-loss-freq-loss-1">
<span id="espnet2-gan-codec-shared-loss-freq-loss"></span><h2>espnet2.gan_codec.shared.loss.freq_loss<a class="headerlink" href="#espnet2-gan-codec-shared-loss-freq-loss-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.loss.freq_loss"></span><p>Frequency-Related Loss</p>
<dl class="class">
<dt id="espnet2.gan_codec.shared.loss.freq_loss.MultiScaleMelSpectrogramLoss">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.loss.freq_loss.</code><code class="sig-name descname">MultiScaleMelSpectrogramLoss</code><span class="sig-paren">(</span><em class="sig-param">fs: int = 22050</em>, <em class="sig-param">range_start: int = 6</em>, <em class="sig-param">range_end: int = 11</em>, <em class="sig-param">window: str = 'hann'</em>, <em class="sig-param">n_mels: int = 80</em>, <em class="sig-param">fmin: Optional[int] = 0</em>, <em class="sig-param">fmax: Optional[int] = None</em>, <em class="sig-param">center: bool = True</em>, <em class="sig-param">normalized: bool = False</em>, <em class="sig-param">onesided: bool = True</em>, <em class="sig-param">log_base: Optional[float] = 10.0</em>, <em class="sig-param">alphas: bool = True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/loss/freq_loss.html#MultiScaleMelSpectrogramLoss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.loss.freq_loss.MultiScaleMelSpectrogramLoss" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Multi-Scale spectrogram loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fs</strong> (<em>int</em>) – Sampling rate.</p></li>
<li><p><strong>range_start</strong> (<em>int</em>) – Power of 2 to use for the first scale.</p></li>
<li><p><strong>range_stop</strong> (<em>int</em>) – Power of 2 to use for the last scale.</p></li>
<li><p><strong>window</strong> (<em>str</em>) – Window type.</p></li>
<li><p><strong>n_mels</strong> (<em>int</em>) – Number of mel bins.</p></li>
<li><p><strong>fmin</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Minimum frequency for Mel.</p></li>
<li><p><strong>fmax</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Maximum frequency for Mel.</p></li>
<li><p><strong>center</strong> (<em>bool</em>) – Whether to use center window.</p></li>
<li><p><strong>normalized</strong> (<em>bool</em>) – Whether to use normalized one.</p></li>
<li><p><strong>onesided</strong> (<em>bool</em>) – Whether to use oneseded one.</p></li>
<li><p><strong>log_base</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Log base value.</p></li>
<li><p><strong>alphas</strong> (<em>bool</em>) – Whether to use alphas as coefficients or not..</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.shared.loss.freq_loss.MultiScaleMelSpectrogramLoss.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">y_hat: torch.Tensor</em>, <em class="sig-param">y: torch.Tensor</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/espnet2/gan_codec/shared/loss/freq_loss.html#MultiScaleMelSpectrogramLoss.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.loss.freq_loss.MultiScaleMelSpectrogramLoss.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Mel-spectrogram loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_hat</strong> (<em>Tensor</em>) – Generated waveform tensor (B, 1, T).</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Groundtruth waveform tensor (B, 1, T).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mel-spectrogram loss value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="espnet2-gan-codec-shared-decoder-seanet-1">
<span id="espnet2-gan-codec-shared-decoder-seanet"></span><h2>espnet2.gan_codec.shared.decoder.seanet<a class="headerlink" href="#espnet2-gan-codec-shared-decoder-seanet-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.decoder.seanet"></span><p>Encodec SEANet-based encoder and decoder implementation.</p>
<dl class="class">
<dt id="espnet2.gan_codec.shared.decoder.seanet.NormConvTranspose1d">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.decoder.seanet.</code><code class="sig-name descname">NormConvTranspose1d</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">causal: bool = False</em>, <em class="sig-param">norm: str = 'none'</em>, <em class="sig-param">norm_kwargs: Dict[str</em>, <em class="sig-param">Any] = {}</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet.html#NormConvTranspose1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet.NormConvTranspose1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Wrapper around ConvTranspose1d and normalization applied to this conv
to provide a uniform interface across normalization approaches.</p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.decoder.seanet.NormConvTranspose1d.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet.html#NormConvTranspose1d.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet.NormConvTranspose1d.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.decoder.seanet.SConvTranspose1d">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.decoder.seanet.</code><code class="sig-name descname">SConvTranspose1d</code><span class="sig-paren">(</span><em class="sig-param">in_channels: int</em>, <em class="sig-param">out_channels: int</em>, <em class="sig-param">kernel_size: int</em>, <em class="sig-param">stride: int = 1</em>, <em class="sig-param">causal: bool = False</em>, <em class="sig-param">norm: str = 'none'</em>, <em class="sig-param">trim_right_ratio: float = 1.0</em>, <em class="sig-param">norm_kwargs: Dict[str</em>, <em class="sig-param">Any] = {}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet.html#SConvTranspose1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet.SConvTranspose1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>ConvTranspose1d with some builtin handling of asymmetric or causal padding
and normalization.</p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.decoder.seanet.SConvTranspose1d.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet.html#SConvTranspose1d.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet.SConvTranspose1d.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.decoder.seanet.SEANetDecoder">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.decoder.seanet.</code><code class="sig-name descname">SEANetDecoder</code><span class="sig-paren">(</span><em class="sig-param">channels: int = 1, dimension: int = 128, n_filters: int = 32, n_residual_layers: int = 1, ratios: List[int] = [8, 5, 4, 2], activation: str = 'ELU', activation_params: dict = {'alpha': 1.0}, final_activation: Optional[str] = None, final_activation_params: Optional[dict] = None, norm: str = 'weight_norm', norm_params: Dict[str, Any] = {}, kernel_size: int = 7, last_kernel_size: int = 7, residual_kernel_size: int = 3, dilation_base: int = 2, causal: bool = False, pad_mode: str = 'reflect', true_skip: bool = False, compress: int = 2, lstm: int = 2, trim_right_ratio: float = 1.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet.html#SEANetDecoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet.SEANetDecoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>SEANet decoder.
:param channels: Audio channels.
:type channels: int
:param dimension: Intermediate representation dimension.
:type dimension: int
:param n_filters: Base width for the model.
:type n_filters: int
:param n_residual_layers: nb of residual layers.
:type n_residual_layers: int
:param ratios: kernel size and stride ratios
:type ratios: Sequence[int]
:param activation: Activation function.
:type activation: str
:param activation_params: Parameters to provide to the activation function
:type activation_params: dict
:param final_activation: Final activation function after all convolutions.
:type final_activation: str
:param final_activation_params: Parameters to provide to the activation function
:type final_activation_params: dict
:param norm: Normalization method.
:type norm: str
:param norm_params: Parameters to provide to the underlying normalization</p>
<blockquote>
<div><p>used along with the convolution.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel_size</strong> (<em>int</em>) – Kernel size for the initial convolution.</p></li>
<li><p><strong>last_kernel_size</strong> (<em>int</em>) – Kernel size for the initial convolution.</p></li>
<li><p><strong>residual_kernel_size</strong> (<em>int</em>) – Kernel size for the residual layers.</p></li>
<li><p><strong>dilation_base</strong> (<em>int</em>) – How much to increase the dilation with each layer.</p></li>
<li><p><strong>causal</strong> (<em>bool</em>) – Whether to use fully causal convolution.</p></li>
<li><p><strong>pad_mode</strong> (<em>str</em>) – Padding mode for the convolutions.</p></li>
<li><p><strong>true_skip</strong> (<em>bool</em>) – Whether to use true skip connection or a simple (streamable)
convolution as the skip connection in the residual network blocks.</p></li>
<li><p><strong>compress</strong> (<em>int</em>) – Reduced dimensionality in residual branches (from Demucs v3).</p></li>
<li><p><strong>lstm</strong> (<em>int</em>) – Number of LSTM layers at the end of the encoder.</p></li>
<li><p><strong>trim_right_ratio</strong> (<em>float</em>) – Ratio for trimming at the right of the transposed
convolution under the causal setup. If equal to 1.0, it means that all
the trimming is done at the right.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.shared.decoder.seanet.SEANetDecoder.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">z</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet.html#SEANetDecoder.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet.SEANetDecoder.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.decoder.seanet.unpad1d">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.decoder.seanet.</code><code class="sig-name descname">unpad1d</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor, paddings: Tuple[int, int]</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet.html#unpad1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet.unpad1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove padding from x, handling properly zero padding. Only for 1d!</p>
</dd></dl>

</section>
<section id="espnet2-gan-codec-shared-decoder-init-1">
<span id="espnet2-gan-codec-shared-decoder-init"></span><h2>espnet2.gan_codec.shared.decoder.__init__<a class="headerlink" href="#espnet2-gan-codec-shared-decoder-init-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.decoder.__init__"></span></section>
<section id="espnet2-gan-codec-shared-decoder-seanet-2d-1">
<span id="espnet2-gan-codec-shared-decoder-seanet-2d"></span><h2>espnet2.gan_codec.shared.decoder.seanet_2d<a class="headerlink" href="#espnet2-gan-codec-shared-decoder-seanet-2d-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.decoder.seanet_2d"></span><dl class="class">
<dt id="espnet2.gan_codec.shared.decoder.seanet_2d.NormConvTranspose2d">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.decoder.seanet_2d.</code><code class="sig-name descname">NormConvTranspose2d</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">causal: bool = False</em>, <em class="sig-param">norm: str = 'none'</em>, <em class="sig-param">norm_kwargs: Dict[str</em>, <em class="sig-param">Any] = {}</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet_2d.html#NormConvTranspose2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet_2d.NormConvTranspose2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Wrapper around ConvTranspose2d and normalization applied to this conv
to provide a uniform interface across normalization approaches.</p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.decoder.seanet_2d.NormConvTranspose2d.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet_2d.html#NormConvTranspose2d.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet_2d.NormConvTranspose2d.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.decoder.seanet_2d.ReshapeModule">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.decoder.seanet_2d.</code><code class="sig-name descname">ReshapeModule</code><span class="sig-paren">(</span><em class="sig-param">dim=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet_2d.html#ReshapeModule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet_2d.ReshapeModule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.decoder.seanet_2d.ReshapeModule.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet_2d.html#ReshapeModule.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet_2d.ReshapeModule.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.decoder.seanet_2d.SConvTranspose2d">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.decoder.seanet_2d.</code><code class="sig-name descname">SConvTranspose2d</code><span class="sig-paren">(</span><em class="sig-param">in_channels: int, out_channels: int, kernel_size: Union[int, Tuple[int, int]], stride: Union[int, Tuple[int, int]] = 1, causal: bool = False, norm: str = 'none', trim_right_ratio: float = 1.0, norm_kwargs: Dict[str, Any] = {}, out_padding: Union[int, List[Tuple[int, int]]] = 0, groups: int = 1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet_2d.html#SConvTranspose2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet_2d.SConvTranspose2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>ConvTranspose2d with some builtin handling of asymmetric or causal padding
and normalization. Note: causal padding only make sense on time (the last) axis.
Frequency (the second last) axis are always non-causally padded.</p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.decoder.seanet_2d.SConvTranspose2d.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet_2d.html#SConvTranspose2d.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet_2d.SConvTranspose2d.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.decoder.seanet_2d.SEANetDecoder2d">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.decoder.seanet_2d.</code><code class="sig-name descname">SEANetDecoder2d</code><span class="sig-paren">(</span><em class="sig-param">channels: int = 1, dimension: int = 128, n_filters: int = 32, n_residual_layers: int = 1, ratios: List[Tuple[int, int]] = [(4, 1), (4, 1), (4, 2), (4, 1)], activation: str = 'ELU', activation_params: dict = {'alpha': 1.0}, final_activation: Optional[str] = None, final_activation_params: Optional[dict] = None, norm: str = 'weight_norm', norm_params: Dict[str, Any] = {}, kernel_size: int = 7, last_kernel_size: int = 7, residual_kernel_size: int = 3, dilation_base: int = 2, causal: bool = False, pad_mode: str = 'reflect', true_skip: bool = False, compress: int = 2, lstm: int = 2, trim_right_ratio: float = 1.0, res_seq=True, last_out_padding: List[int] = [(0, 1), (0, 0)], tr_conv_group_ratio: int = -1, conv_group_ratio: int = -1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet_2d.html#SEANetDecoder2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet_2d.SEANetDecoder2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>SEANet decoder.
:param channels: Audio channels.
:type channels: int
:param dimension: Intermediate representation dimension.
:type dimension: int
:param n_filters: Base width for the model.
:type n_filters: int
:param n_residual_layers: nb of residual layers.
:type n_residual_layers: int
:param ratios: kernel size and stride ratios
:type ratios: Sequence[int]
:param activation: Activation function.
:type activation: str
:param activation_params: Parameters to provide to the activation function
:type activation_params: dict
:param final_activation: Final activation function after all convolutions.
:type final_activation: str
:param final_activation_params: Parameters to provide to the activation function
:type final_activation_params: dict
:param norm: Normalization method.
:type norm: str
:param norm_params: Parameters to provide to the underlying normalization used</p>
<blockquote>
<div><p>along with the convolution.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel_size</strong> (<em>int</em>) – Kernel size for the initial convolution.</p></li>
<li><p><strong>last_kernel_size</strong> (<em>int</em>) – Kernel size for the initial convolution.</p></li>
<li><p><strong>residual_kernel_size</strong> (<em>int</em>) – Kernel size for the residual layers.</p></li>
<li><p><strong>dilation_base</strong> (<em>int</em>) – How much to increase the dilation with each layer.</p></li>
<li><p><strong>causal</strong> (<em>bool</em>) – Whether to use fully causal convolution.</p></li>
<li><p><strong>pad_mode</strong> (<em>str</em>) – Padding mode for the convolutions.</p></li>
<li><p><strong>true_skip</strong> (<em>bool</em>) – Whether to use true skip connection or a simple (streamable)
convolution as the skip connection in the residual network blocks.</p></li>
<li><p><strong>compress</strong> (<em>int</em>) – Reduced dimensionality in residual branches (from Demucs v3).</p></li>
<li><p><strong>lstm</strong> (<em>int</em>) – Number of LSTM layers at the end of the encoder.</p></li>
<li><p><strong>trim_right_ratio</strong> (<em>float</em>) – Ratio for trimming at the right of the transposed
convolution under the causal setup. If equal to 1.0, it means that all
the trimming is done at the right.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.shared.decoder.seanet_2d.SEANetDecoder2d.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">z</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet_2d.html#SEANetDecoder2d.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet_2d.SEANetDecoder2d.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.decoder.seanet_2d.SEANetDecoder2d.output_size">
<code class="sig-name descname">output_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet_2d.html#SEANetDecoder2d.output_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet_2d.SEANetDecoder2d.output_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.decoder.seanet_2d.SEANetResnetBlock2d">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.decoder.seanet_2d.</code><code class="sig-name descname">SEANetResnetBlock2d</code><span class="sig-paren">(</span><em class="sig-param">dim: int, kernel_sizes: List[Tuple[int, int]] = [(3, 3), (1, 1)], dilations: List[Tuple[int, int]] = [(1, 1), (1, 1)], activation: str = 'ELU', activation_params: dict = {'alpha': 1.0}, norm: str = 'weight_norm', norm_params: Dict[str, Any] = {}, causal: bool = False, pad_mode: str = 'reflect', compress: int = 2, true_skip: bool = True, conv_group_ratio: int = -1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet_2d.html#SEANetResnetBlock2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet_2d.SEANetResnetBlock2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Residual block from SEANet model.
:param dim: Dimension of the input/output
:type dim: int
:param kernel_sizes: List of kernel sizes for the convolutions.
:type kernel_sizes: list
:param dilations: List of dilations for the convolutions.
:type dilations: list
:param activation: Activation function.
:type activation: str
:param activation_params: Parameters to provide to the activation function
:type activation_params: dict
:param norm: Normalization method.
:type norm: str
:param norm_params: Parameters to provide to the underlying normalization</p>
<blockquote>
<div><p>used along with the convolution.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal</strong> (<em>bool</em>) – Whether to use fully causal convolution.</p></li>
<li><p><strong>pad_mode</strong> (<em>str</em>) – Padding mode for the convolutions.</p></li>
<li><p><strong>compress</strong> (<em>int</em>) – Reduced dimensionality in residual branches (from Demucs v3)</p></li>
<li><p><strong>true_skip</strong> (<em>bool</em>) – Whether to use true skip connection or a simple convolution
as the skip connection.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.shared.decoder.seanet_2d.SEANetResnetBlock2d.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet_2d.html#SEANetResnetBlock2d.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet_2d.SEANetResnetBlock2d.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.decoder.seanet_2d.unpad2d">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.decoder.seanet_2d.</code><code class="sig-name descname">unpad2d</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor, paddings: Tuple[Tuple[int, int], Tuple[int, int]]</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/decoder/seanet_2d.html#unpad2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.decoder.seanet_2d.unpad2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove padding from x, handling properly zero padding. Only for 1d!</p>
</dd></dl>

</section>
<section id="espnet2-gan-codec-shared-quantizer-init-1">
<span id="espnet2-gan-codec-shared-quantizer-init"></span><h2>espnet2.gan_codec.shared.quantizer.__init__<a class="headerlink" href="#espnet2-gan-codec-shared-quantizer-init-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.quantizer.__init__"></span></section>
<section id="espnet2-gan-codec-shared-quantizer-residual-vq-1">
<span id="espnet2-gan-codec-shared-quantizer-residual-vq"></span><h2>espnet2.gan_codec.shared.quantizer.residual_vq<a class="headerlink" href="#espnet2-gan-codec-shared-quantizer-residual-vq-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.quantizer.residual_vq"></span><p>Residual vector quantizer implementation.</p>
<dl class="class">
<dt id="espnet2.gan_codec.shared.quantizer.residual_vq.QuantizedResult">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.residual_vq.</code><code class="sig-name descname">QuantizedResult</code><span class="sig-paren">(</span><em class="sig-param">quantized: torch.Tensor</em>, <em class="sig-param">codes: torch.Tensor</em>, <em class="sig-param">bandwidth: torch.Tensor</em>, <em class="sig-param">penalty: Union[torch.Tensor</em>, <em class="sig-param">NoneType] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/residual_vq.html#QuantizedResult"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.residual_vq.QuantizedResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="attribute">
<dt id="espnet2.gan_codec.shared.quantizer.residual_vq.QuantizedResult.penalty">
<code class="sig-name descname">penalty</code><em class="property"> = None</em><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.residual_vq.QuantizedResult.penalty" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.quantizer.residual_vq.ResidualVectorQuantizer">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.residual_vq.</code><code class="sig-name descname">ResidualVectorQuantizer</code><span class="sig-paren">(</span><em class="sig-param">dimension: int = 256</em>, <em class="sig-param">codebook_dim: int = 512</em>, <em class="sig-param">n_q: int = 8</em>, <em class="sig-param">bins: int = 1024</em>, <em class="sig-param">decay: float = 0.99</em>, <em class="sig-param">kmeans_init: bool = True</em>, <em class="sig-param">kmeans_iters: int = 50</em>, <em class="sig-param">threshold_ema_dead_code: int = 2</em>, <em class="sig-param">quantizer_dropout: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/residual_vq.html#ResidualVectorQuantizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.residual_vq.ResidualVectorQuantizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Residual Vector Quantizer.
:param dimension: Dimension of the codebooks.
:type dimension: int
:param n_q: Number of residual vector quantizers used.
:type n_q: int
:param bins: Codebook size.
:type bins: int
:param decay: Decay for exponential moving average over the codebooks.
:type decay: float
:param kmeans_init: Whether to use kmeans to initialize the codebooks.
:type kmeans_init: bool
:param kmeans_iters: Number of iterations used for kmeans initialization.
:type kmeans_iters: int
:param threshold_ema_dead_code: Threshold for dead code expiration.</p>
<blockquote>
<div><p>Replace any codes that have an exponential moving average cluster
size less than the specified threshold with
randomly selected vector from the current batch.</p>
</div></blockquote>
<dl class="field-list simple">
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.residual_vq.ResidualVectorQuantizer.decode">
<code class="sig-name descname">decode</code><span class="sig-paren">(</span><em class="sig-param">codes: torch.Tensor</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/residual_vq.html#ResidualVectorQuantizer.decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.residual_vq.ResidualVectorQuantizer.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode the given codes to the quantized representation.</p>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.residual_vq.ResidualVectorQuantizer.encode">
<code class="sig-name descname">encode</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">sample_rate: int</em>, <em class="sig-param">bandwidth: Optional[float] = None</em>, <em class="sig-param">st: Optional[int] = None</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/residual_vq.html#ResidualVectorQuantizer.encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.residual_vq.ResidualVectorQuantizer.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode a given input tensor with the specified sample rate at
the given bandwidth. The RVQ encode method sets the appropriate
number of quantizer to use and returns indices for each quantizer.</p>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.residual_vq.ResidualVectorQuantizer.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">sample_rate: int</em>, <em class="sig-param">bandwidth: Optional[float] = None</em><span class="sig-paren">)</span> &#x2192; espnet2.gan_codec.shared.quantizer.residual_vq.QuantizedResult<a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/residual_vq.html#ResidualVectorQuantizer.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.residual_vq.ResidualVectorQuantizer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Residual vector quantization on the given input tensor.
:param x: Input tensor.
:type x: torch.Tensor
:param sample_rate: Sample rate of the input tensor.
:type sample_rate: int
:param bandwidth: Target bandwidth.
:type bandwidth: float</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The quantized (or approximately quantized) representation with
the associated bandwidth and any penalty term for the loss.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#espnet2.gan_codec.shared.quantizer.residual_vq.QuantizedResult" title="espnet2.gan_codec.shared.quantizer.residual_vq.QuantizedResult">QuantizedResult</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.residual_vq.ResidualVectorQuantizer.get_bandwidth_per_quantizer">
<code class="sig-name descname">get_bandwidth_per_quantizer</code><span class="sig-paren">(</span><em class="sig-param">sample_rate: int</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/residual_vq.html#ResidualVectorQuantizer.get_bandwidth_per_quantizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.residual_vq.ResidualVectorQuantizer.get_bandwidth_per_quantizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Return bandwidth per quantizer for a given input sample rate.</p>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.residual_vq.ResidualVectorQuantizer.get_num_quantizers_for_bandwidth">
<code class="sig-name descname">get_num_quantizers_for_bandwidth</code><span class="sig-paren">(</span><em class="sig-param">sample_rate: int</em>, <em class="sig-param">bandwidth: Optional[float] = None</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/residual_vq.html#ResidualVectorQuantizer.get_num_quantizers_for_bandwidth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.residual_vq.ResidualVectorQuantizer.get_num_quantizers_for_bandwidth" title="Permalink to this definition">¶</a></dt>
<dd><p>Return n_q based on specified target bandwidth.</p>
</dd></dl>

</dd></dl>

</section>
<section id="espnet2-gan-codec-shared-quantizer-modules-init-1">
<span id="espnet2-gan-codec-shared-quantizer-modules-init"></span><h2>espnet2.gan_codec.shared.quantizer.modules.__init__<a class="headerlink" href="#espnet2-gan-codec-shared-quantizer-modules-init-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.quantizer.modules.__init__"></span></section>
<section id="espnet2-gan-codec-shared-quantizer-modules-distrib-1">
<span id="espnet2-gan-codec-shared-quantizer-modules-distrib"></span><h2>espnet2.gan_codec.shared.quantizer.modules.distrib<a class="headerlink" href="#espnet2-gan-codec-shared-quantizer-modules-distrib-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.quantizer.modules.distrib"></span><p>Torch distributed utilities.</p>
<dl class="function">
<dt id="espnet2.gan_codec.shared.quantizer.modules.distrib.all_reduce">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.modules.distrib.</code><code class="sig-name descname">all_reduce</code><span class="sig-paren">(</span><em class="sig-param">tensor: torch.Tensor</em>, <em class="sig-param">op=&lt;RedOpType.SUM: 0&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/distrib.html#all_reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.distrib.all_reduce" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.quantizer.modules.distrib.average_metrics">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.modules.distrib.</code><code class="sig-name descname">average_metrics</code><span class="sig-paren">(</span><em class="sig-param">metrics: Dict[str, float], count=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/distrib.html#average_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.distrib.average_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Average a dictionary of metrics across all workers, using the optional
<cite>count</cite> as unormalized weight.</p>
</dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.quantizer.modules.distrib.broadcast_tensors">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.modules.distrib.</code><code class="sig-name descname">broadcast_tensors</code><span class="sig-paren">(</span><em class="sig-param">tensors: Iterable[torch.Tensor], src: int = 0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/distrib.html#broadcast_tensors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.distrib.broadcast_tensors" title="Permalink to this definition">¶</a></dt>
<dd><p>Broadcast the tensors from the given parameters to all workers.
This can be used to ensure that all workers have the same model to start with.</p>
</dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.quantizer.modules.distrib.is_distributed">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.modules.distrib.</code><code class="sig-name descname">is_distributed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/distrib.html#is_distributed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.distrib.is_distributed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.quantizer.modules.distrib.rank">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.modules.distrib.</code><code class="sig-name descname">rank</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/distrib.html#rank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.distrib.rank" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.quantizer.modules.distrib.sync_buffer">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.modules.distrib.</code><code class="sig-name descname">sync_buffer</code><span class="sig-paren">(</span><em class="sig-param">buffers</em>, <em class="sig-param">average=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/distrib.html#sync_buffer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.distrib.sync_buffer" title="Permalink to this definition">¶</a></dt>
<dd><p>Sync grad for buffers. If average is False, broadcast instead of averaging.</p>
</dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.quantizer.modules.distrib.sync_grad">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.modules.distrib.</code><code class="sig-name descname">sync_grad</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/distrib.html#sync_grad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.distrib.sync_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Simpler alternative to DistributedDataParallel, that doesn’t rely
on any black magic. For simple models it can also be as fast.
Just call this on your model parameters after the call to backward!</p>
</dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.quantizer.modules.distrib.world_size">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.modules.distrib.</code><code class="sig-name descname">world_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/distrib.html#world_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.distrib.world_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="espnet2-gan-codec-shared-quantizer-modules-core-vq-1">
<span id="espnet2-gan-codec-shared-quantizer-modules-core-vq"></span><h2>espnet2.gan_codec.shared.quantizer.modules.core_vq<a class="headerlink" href="#espnet2-gan-codec-shared-quantizer-modules-core-vq-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.quantizer.modules.core_vq"></span><p>Core vector quantization implementation.</p>
<dl class="class">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.modules.core_vq.</code><code class="sig-name descname">EuclideanCodebook</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em>, <em class="sig-param">codebook_size: int</em>, <em class="sig-param">kmeans_init: int = False</em>, <em class="sig-param">kmeans_iters: int = 10</em>, <em class="sig-param">decay: float = 0.99</em>, <em class="sig-param">epsilon: float = 1e-05</em>, <em class="sig-param">threshold_ema_dead_code: int = 2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#EuclideanCodebook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Codebook with Euclidean distance.
:param dim: Dimension.
:type dim: int
:param codebook_size: Codebook size.
:type codebook_size: int
:param kmeans_init: Whether to use k-means to initialize the codebooks.</p>
<blockquote>
<div><p>If set to true, run the k-means algorithm on the first training batch
and use the learned centroids as initialization.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kmeans_iters</strong> (<em>int</em>) – Number of iterations used for k-means algorithm at
initialization.</p></li>
<li><p><strong>decay</strong> (<em>float</em>) – Decay for exponential moving average over the codebooks.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – Epsilon value for numerical stability.</p></li>
<li><p><strong>threshold_ema_dead_code</strong> (<em>int</em>) – Threshold for dead code expiration.
Replace any codes that have an exponential moving average cluster size
less than the specified threshold with randomly selected vector from
the current batch.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.decode">
<code class="sig-name descname">decode</code><span class="sig-paren">(</span><em class="sig-param">embed_ind</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#EuclideanCodebook.decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.decode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.dequantize">
<code class="sig-name descname">dequantize</code><span class="sig-paren">(</span><em class="sig-param">embed_ind</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#EuclideanCodebook.dequantize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.dequantize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.encode">
<code class="sig-name descname">encode</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#EuclideanCodebook.encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.encode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.expire_codes_">
<code class="sig-name descname">expire_codes_</code><span class="sig-paren">(</span><em class="sig-param">batch_samples</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#EuclideanCodebook.expire_codes_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.expire_codes_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#EuclideanCodebook.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Codebook Forward with EMA.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Vector for quantization (B, T, D)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Quantized output (B, T, D)
Tensor: Codebook Index (B, T)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.init_embed_">
<code class="sig-name descname">init_embed_</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#EuclideanCodebook.init_embed_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.init_embed_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.postprocess_emb">
<code class="sig-name descname">postprocess_emb</code><span class="sig-paren">(</span><em class="sig-param">embed_ind</em>, <em class="sig-param">shape</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#EuclideanCodebook.postprocess_emb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.postprocess_emb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.preprocess">
<code class="sig-name descname">preprocess</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#EuclideanCodebook.preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.preprocess" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.quantize">
<code class="sig-name descname">quantize</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#EuclideanCodebook.quantize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.quantize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.replace_">
<code class="sig-name descname">replace_</code><span class="sig-paren">(</span><em class="sig-param">samples</em>, <em class="sig-param">mask</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#EuclideanCodebook.replace_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.EuclideanCodebook.replace_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.ResidualVectorQuantization">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.modules.core_vq.</code><code class="sig-name descname">ResidualVectorQuantization</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">num_quantizers</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#ResidualVectorQuantization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.ResidualVectorQuantization" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Residual vector quantization implementation.</p>
<p>Follows Algorithm 1. in <a class="reference external" href="https://arxiv.org/pdf/2107.03312.pdf">https://arxiv.org/pdf/2107.03312.pdf</a></p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.ResidualVectorQuantization.decode">
<code class="sig-name descname">decode</code><span class="sig-paren">(</span><em class="sig-param">q_indices: torch.Tensor</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#ResidualVectorQuantization.decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.ResidualVectorQuantization.decode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.ResidualVectorQuantization.encode">
<code class="sig-name descname">encode</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">n_q: Optional[int] = None</em>, <em class="sig-param">st: Optional[int] = None</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#ResidualVectorQuantization.encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.ResidualVectorQuantization.encode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.ResidualVectorQuantization.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">n_q: Optional[int] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#ResidualVectorQuantization.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.ResidualVectorQuantization.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.VectorQuantization">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.modules.core_vq.</code><code class="sig-name descname">VectorQuantization</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em>, <em class="sig-param">codebook_size: int</em>, <em class="sig-param">codebook_dim: Optional[int] = None</em>, <em class="sig-param">decay: float = 0.99</em>, <em class="sig-param">epsilon: float = 1e-05</em>, <em class="sig-param">kmeans_init: bool = True</em>, <em class="sig-param">kmeans_iters: int = 50</em>, <em class="sig-param">threshold_ema_dead_code: int = 2</em>, <em class="sig-param">commitment_weight: float = 1.0</em>, <em class="sig-param">quantizer_dropout: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#VectorQuantization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.VectorQuantization" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Vector quantization implementation.
Currently supports only euclidean distance.
:param dim: Dimension
:type dim: int
:param codebook_size: Codebook size
:type codebook_size: int
:param codebook_dim: Codebook dimension. If not defined, uses the specified</p>
<blockquote>
<div><p>dimension in dim.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>decay</strong> (<em>float</em>) – Decay for exponential moving average over the codebooks.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – Epsilon value for numerical stability.</p></li>
<li><p><strong>kmeans_init</strong> (<em>bool</em>) – Whether to use kmeans to initialize the codebooks.</p></li>
<li><p><strong>kmeans_iters</strong> (<em>int</em>) – Number of iterations used for kmeans initialization.</p></li>
<li><p><strong>threshold_ema_dead_code</strong> (<em>int</em>) – Threshold for dead code expiration.
Replace any codes that have an exponential moving average cluster size
less than the specified threshold with randomly selected vector from
the current batch.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.VectorQuantization.codebook">
<em class="property">property </em><code class="sig-name descname">codebook</code><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.VectorQuantization.codebook" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.VectorQuantization.decode">
<code class="sig-name descname">decode</code><span class="sig-paren">(</span><em class="sig-param">embed_ind</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#VectorQuantization.decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.VectorQuantization.decode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.VectorQuantization.encode">
<code class="sig-name descname">encode</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#VectorQuantization.encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.VectorQuantization.encode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.VectorQuantization.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">mask=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#VectorQuantization.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.VectorQuantization.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.default">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.modules.core_vq.</code><code class="sig-name descname">default</code><span class="sig-paren">(</span><em class="sig-param">val: Any</em>, <em class="sig-param">d: Any</em><span class="sig-paren">)</span> &#x2192; Any<a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#default"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.default" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.ema_inplace">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.modules.core_vq.</code><code class="sig-name descname">ema_inplace</code><span class="sig-paren">(</span><em class="sig-param">moving_avg</em>, <em class="sig-param">new</em>, <em class="sig-param">decay: float</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#ema_inplace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.ema_inplace" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.kmeans">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.modules.core_vq.</code><code class="sig-name descname">kmeans</code><span class="sig-paren">(</span><em class="sig-param">samples</em>, <em class="sig-param">num_clusters: int</em>, <em class="sig-param">num_iters: int = 10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#kmeans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.kmeans" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.laplace_smoothing">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.modules.core_vq.</code><code class="sig-name descname">laplace_smoothing</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">n_categories: int</em>, <em class="sig-param">epsilon: float = 1e-05</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#laplace_smoothing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.laplace_smoothing" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.sample_vectors">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.modules.core_vq.</code><code class="sig-name descname">sample_vectors</code><span class="sig-paren">(</span><em class="sig-param">samples</em>, <em class="sig-param">num: int</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#sample_vectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.sample_vectors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.quantizer.modules.core_vq.uniform_init">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.quantizer.modules.core_vq.</code><code class="sig-name descname">uniform_init</code><span class="sig-paren">(</span><em class="sig-param">*shape</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/quantizer/modules/core_vq.html#uniform_init"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.quantizer.modules.core_vq.uniform_init" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="espnet2-gan-codec-shared-encoder-seanet-1">
<span id="espnet2-gan-codec-shared-encoder-seanet"></span><h2>espnet2.gan_codec.shared.encoder.seanet<a class="headerlink" href="#espnet2-gan-codec-shared-encoder-seanet-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.encoder.seanet"></span><p>Encodec SEANet-based encoder and decoder implementation.</p>
<dl class="class">
<dt id="espnet2.gan_codec.shared.encoder.seanet.ConvLayerNorm">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet.</code><code class="sig-name descname">ConvLayerNorm</code><span class="sig-paren">(</span><em class="sig-param">normalized_shape: Union[int, List[int], torch.Size], **kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet.html#ConvLayerNorm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet.ConvLayerNorm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.normalization.LayerNorm</span></code></p>
<p>Convolution-friendly LayerNorm that moves channels to last dimensions
before running the normalization and moves them back to
original position right after.</p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.encoder.seanet.ConvLayerNorm.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet.html#ConvLayerNorm.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet.ConvLayerNorm.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.encoder.seanet.NormConv1d">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet.</code><code class="sig-name descname">NormConv1d</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">causal: bool = False</em>, <em class="sig-param">norm: str = 'none'</em>, <em class="sig-param">norm_kwargs: Dict[str</em>, <em class="sig-param">Any] = {}</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet.html#NormConv1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet.NormConv1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Wrapper around Conv1d and normalization applied to this conv
to provide a uniform interface across normalization approaches.</p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.encoder.seanet.NormConv1d.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet.html#NormConv1d.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet.NormConv1d.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.encoder.seanet.SConv1d">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet.</code><code class="sig-name descname">SConv1d</code><span class="sig-paren">(</span><em class="sig-param">in_channels: int</em>, <em class="sig-param">out_channels: int</em>, <em class="sig-param">kernel_size: int</em>, <em class="sig-param">stride: int = 1</em>, <em class="sig-param">dilation: int = 1</em>, <em class="sig-param">groups: int = 1</em>, <em class="sig-param">bias: bool = True</em>, <em class="sig-param">causal: bool = False</em>, <em class="sig-param">norm: str = 'none'</em>, <em class="sig-param">norm_kwargs: Dict[str</em>, <em class="sig-param">Any] = {}</em>, <em class="sig-param">pad_mode: str = 'reflect'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet.html#SConv1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet.SConv1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Conv1d with some builtin handling of asymmetric or causal padding
and normalization.</p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.encoder.seanet.SConv1d.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet.html#SConv1d.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet.SConv1d.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.encoder.seanet.SEANetEncoder">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet.</code><code class="sig-name descname">SEANetEncoder</code><span class="sig-paren">(</span><em class="sig-param">channels: int = 1, dimension: int = 128, n_filters: int = 32, n_residual_layers: int = 1, ratios: List[int] = [8, 5, 4, 2], activation: str = 'ELU', activation_params: dict = {'alpha': 1.0}, norm: str = 'weight_norm', norm_params: Dict[str, Any] = {}, kernel_size: int = 7, last_kernel_size: int = 7, residual_kernel_size: int = 3, dilation_base: int = 2, causal: bool = False, pad_mode: str = 'reflect', true_skip: bool = False, compress: int = 2, lstm: int = 2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet.html#SEANetEncoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet.SEANetEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>SEANet encoder.
:param channels: Audio channels.
:type channels: int
:param dimension: Intermediate representation dimension.
:type dimension: int
:param n_filters: Base width for the model.
:type n_filters: int
:param n_residual_layers: nb of residual layers.
:type n_residual_layers: int
:param ratios: kernel size and stride ratios. The encoder</p>
<blockquote>
<div><p>uses downsampling ratios instead of upsampling ratios, hence
it will use the ratios in the reverse order to the ones specified
here that must match the decoder order</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>activation</strong> (<em>str</em>) – Activation function.</p></li>
<li><p><strong>activation_params</strong> (<em>dict</em>) – Parameters to provide to the activation function</p></li>
<li><p><strong>norm</strong> (<em>str</em>) – Normalization method.</p></li>
<li><p><strong>norm_params</strong> (<em>dict</em>) – Parameters to provide to the underlying normalization
used along with the convolution.</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em>) – Kernel size for the initial convolution.</p></li>
<li><p><strong>last_kernel_size</strong> (<em>int</em>) – Kernel size for the initial convolution.</p></li>
<li><p><strong>residual_kernel_size</strong> (<em>int</em>) – Kernel size for the residual layers.</p></li>
<li><p><strong>dilation_base</strong> (<em>int</em>) – How much to increase the dilation with each layer.</p></li>
<li><p><strong>causal</strong> (<em>bool</em>) – Whether to use fully causal convolution.</p></li>
<li><p><strong>pad_mode</strong> (<em>str</em>) – Padding mode for the convolutions.</p></li>
<li><p><strong>true_skip</strong> (<em>bool</em>) – Whether to use true skip connection or a simple (streamable)
convolution as the skip connection in the residual network blocks.</p></li>
<li><p><strong>compress</strong> (<em>int</em>) – Reduced dimensionality in residual branches (from Demucs v3).</p></li>
<li><p><strong>lstm</strong> (<em>int</em>) – Number of LSTM layers at the end of the encoder.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.shared.encoder.seanet.SEANetEncoder.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet.html#SEANetEncoder.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet.SEANetEncoder.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.encoder.seanet.SEANetResnetBlock">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet.</code><code class="sig-name descname">SEANetResnetBlock</code><span class="sig-paren">(</span><em class="sig-param">dim: int, kernel_sizes: List[int] = [3, 1], dilations: List[int] = [1, 1], activation: str = 'ELU', activation_params: dict = {'alpha': 1.0}, norm: str = 'weight_norm', norm_params: Dict[str, Any] = {}, causal: bool = False, pad_mode: str = 'reflect', compress: int = 2, true_skip: bool = True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet.html#SEANetResnetBlock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet.SEANetResnetBlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Residual block from SEANet model.
:param dim: Dimension of the input/output
:type dim: int
:param kernel_sizes: List of kernel sizes for the convolutions.
:type kernel_sizes: list
:param dilations: List of dilations for the convolutions.
:type dilations: list
:param activation: Activation function.
:type activation: str
:param activation_params: Parameters to provide to the activation function
:type activation_params: dict
:param norm: Normalization method.
:type norm: str
:param norm_params: Parameters to provide to the underlying normalization</p>
<blockquote>
<div><p>used along with the convolution.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal</strong> (<em>bool</em>) – Whether to use fully causal convolution.</p></li>
<li><p><strong>pad_mode</strong> (<em>str</em>) – Padding mode for the convolutions.</p></li>
<li><p><strong>compress</strong> (<em>int</em>) – Reduced dimensionality in residual branches (from Demucs v3)</p></li>
<li><p><strong>true_skip</strong> (<em>bool</em>) – Whether to use true skip connection or a simple convolution
as the skip connection.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.shared.encoder.seanet.SEANetResnetBlock.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet.html#SEANetResnetBlock.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet.SEANetResnetBlock.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.encoder.seanet.SLSTM">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet.</code><code class="sig-name descname">SLSTM</code><span class="sig-paren">(</span><em class="sig-param">dimension: int</em>, <em class="sig-param">num_layers: int = 2</em>, <em class="sig-param">skip: bool = True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet.html#SLSTM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet.SLSTM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>LSTM without worrying about the hidden state, nor the layout of the data.
Expects input as convolutional layout.</p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.encoder.seanet.SLSTM.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet.html#SLSTM.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet.SLSTM.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.encoder.seanet.apply_parametrization_norm">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet.</code><code class="sig-name descname">apply_parametrization_norm</code><span class="sig-paren">(</span><em class="sig-param">module: torch.nn.modules.module.Module</em>, <em class="sig-param">norm: str = 'none'</em><span class="sig-paren">)</span> &#x2192; torch.nn.modules.module.Module<a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet.html#apply_parametrization_norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet.apply_parametrization_norm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.encoder.seanet.get_extra_padding_for_conv1d">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet.</code><code class="sig-name descname">get_extra_padding_for_conv1d</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">kernel_size: int</em>, <em class="sig-param">stride: int</em>, <em class="sig-param">padding_total: int = 0</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet.html#get_extra_padding_for_conv1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet.get_extra_padding_for_conv1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Pad for a convolution to make sure that the last window is full.
Extra padding is added at the end. This is required to ensure that we can rebuild
an output of the same length, as otherwise, even with padding, some time steps
might get removed.
For instance, with total padding = 4, kernel size = 4, stride = 2:</p>
<blockquote>
<div><p>0 0 1 2 3 4 5 0 0 # (0s are padding)
1   2   3         # (out-frames of a convolution, last 0 is never used)
0 0 1 2 3 4 5 0   # (out-tr.conv., but pos.5 will get removed as padding)</p>
<blockquote>
<div><p>1 2 3 4       # once you removed padding, we are missing one time step !</p>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.encoder.seanet.get_norm_module">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet.</code><code class="sig-name descname">get_norm_module</code><span class="sig-paren">(</span><em class="sig-param">module: torch.nn.modules.module.Module</em>, <em class="sig-param">causal: bool = False</em>, <em class="sig-param">norm: str = 'none'</em>, <em class="sig-param">**norm_kwargs</em><span class="sig-paren">)</span> &#x2192; torch.nn.modules.module.Module<a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet.html#get_norm_module"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet.get_norm_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the proper normalization module. If causal is True, this will
ensure the returned module is causal, or return an error if the
normalization doesn’t support causal evaluation.</p>
</dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.encoder.seanet.pad1d">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet.</code><code class="sig-name descname">pad1d</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor, paddings: Tuple[int, int], mode: str = 'zero', value: float = 0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet.html#pad1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet.pad1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Tiny wrapper around F.pad, just to allow for reflect padding on small input.
If this is the case, we insert extra 0 padding to the right before
the reflection happen.</p>
</dd></dl>

</section>
<section id="espnet2-gan-codec-shared-encoder-snake-activation-1">
<span id="espnet2-gan-codec-shared-encoder-snake-activation"></span><h2>espnet2.gan_codec.shared.encoder.snake_activation<a class="headerlink" href="#espnet2-gan-codec-shared-encoder-snake-activation-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.encoder.snake_activation"></span><dl class="class">
<dt id="espnet2.gan_codec.shared.encoder.snake_activation.Snake1d">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.snake_activation.</code><code class="sig-name descname">Snake1d</code><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/snake_activation.html#Snake1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.snake_activation.Snake1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.encoder.snake_activation.Snake1d.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/snake_activation.html#Snake1d.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.snake_activation.Snake1d.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

</section>
<section id="espnet2-gan-codec-shared-encoder-init-1">
<span id="espnet2-gan-codec-shared-encoder-init"></span><h2>espnet2.gan_codec.shared.encoder.__init__<a class="headerlink" href="#espnet2-gan-codec-shared-encoder-init-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.encoder.__init__"></span></section>
<section id="espnet2-gan-codec-shared-encoder-seanet-2d-1">
<span id="espnet2-gan-codec-shared-encoder-seanet-2d"></span><h2>espnet2.gan_codec.shared.encoder.seanet_2d<a class="headerlink" href="#espnet2-gan-codec-shared-encoder-seanet-2d-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.shared.encoder.seanet_2d"></span><p>Encodec SEANet-based encoder and decoder implementation.</p>
<dl class="class">
<dt id="espnet2.gan_codec.shared.encoder.seanet_2d.NormConv2d">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet_2d.</code><code class="sig-name descname">NormConv2d</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">causal: bool = False</em>, <em class="sig-param">norm: str = 'none'</em>, <em class="sig-param">norm_kwargs: Dict[str</em>, <em class="sig-param">Any] = {}</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet_2d.html#NormConv2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet_2d.NormConv2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Wrapper around Conv2d and normalization applied to this conv
to provide a uniform interface across normalization approaches.</p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.encoder.seanet_2d.NormConv2d.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet_2d.html#NormConv2d.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet_2d.NormConv2d.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.encoder.seanet_2d.ReshapeModule">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet_2d.</code><code class="sig-name descname">ReshapeModule</code><span class="sig-paren">(</span><em class="sig-param">dim=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet_2d.html#ReshapeModule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet_2d.ReshapeModule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.encoder.seanet_2d.ReshapeModule.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet_2d.html#ReshapeModule.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet_2d.ReshapeModule.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.encoder.seanet_2d.SConv2d">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet_2d.</code><code class="sig-name descname">SConv2d</code><span class="sig-paren">(</span><em class="sig-param">in_channels: int, out_channels: int, kernel_size: Union[int, Tuple[int, int]], stride: Union[int, Tuple[int, int]] = 1, dilation: Union[int, Tuple[int, int]] = 1, groups: int = 1, bias: bool = True, causal: bool = False, norm: str = 'none', norm_kwargs: Dict[str, Any] = {}, pad_mode: str = 'reflect'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet_2d.html#SConv2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet_2d.SConv2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Conv1d with some builtin handling of asymmetric or causal padding
and normalization. Note: causal padding only make sense on time (the last) axis.
Frequency (the second last) axis are always non-causally padded.</p>
<dl class="method">
<dt id="espnet2.gan_codec.shared.encoder.seanet_2d.SConv2d.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet_2d.html#SConv2d.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet_2d.SConv2d.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.encoder.seanet_2d.SEANetEncoder2d">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet_2d.</code><code class="sig-name descname">SEANetEncoder2d</code><span class="sig-paren">(</span><em class="sig-param">channels: int = 1, dimension: int = 128, n_filters: int = 32, n_residual_layers: int = 1, ratios: List[Tuple[int, int]] = [(4, 1), (4, 1), (4, 2), (4, 1)], activation: str = 'ELU', activation_params: dict = {'alpha': 1.0}, norm: str = 'weight_norm', norm_params: Dict[str, Any] = {}, kernel_size: int = 7, last_kernel_size: int = 7, residual_kernel_size: int = 3, dilation_base: int = 2, causal: bool = False, pad_mode: str = 'reflect', true_skip: bool = False, compress: int = 2, lstm: int = 2, res_seq=True, conv_group_ratio: int = -1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet_2d.html#SEANetEncoder2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet_2d.SEANetEncoder2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>SEANet encoder.
:param input_size: Audio channels.
:type input_size: int
:param dimension: Intermediate representation dimension.
:type dimension: int
:param n_filters: Base width for the model.
:type n_filters: int
:param n_residual_layers: nb of residual layers.
:type n_residual_layers: int
:param ratios: kernel size and stride ratios. The encoder uses</p>
<blockquote>
<div><p>downsampling ratios instead of upsampling ratios, hence it will use
the ratios in the reverse order to the ones specified here
that must match the decoder order</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>activation</strong> (<em>str</em>) – Activation function. ELU = Exponential Linear Unit</p></li>
<li><p><strong>activation_params</strong> (<em>dict</em>) – Parameters to provide to the activation function</p></li>
<li><p><strong>norm</strong> (<em>str</em>) – Normalization method.</p></li>
<li><p><strong>norm_params</strong> (<em>dict</em>) – Parameters to provide to the underlying normalization
used along with the convolution.</p></li>
<li><p><strong>kernel_size</strong> (<em>int</em>) – Kernel size for the initial convolution.</p></li>
<li><p><strong>last_kernel_size</strong> (<em>int</em>) – Kernel size for the initial convolution.</p></li>
<li><p><strong>residual_kernel_size</strong> (<em>int</em>) – Kernel size for the residual layers.</p></li>
<li><p><strong>dilation_base</strong> (<em>int</em>) – How much to increase the dilation with each layer.</p></li>
<li><p><strong>causal</strong> (<em>bool</em>) – Whether to use fully causal convolution.</p></li>
<li><p><strong>pad_mode</strong> (<em>str</em>) – Padding mode for the convolutions.</p></li>
<li><p><strong>true_skip</strong> (<em>bool</em>) – Whether to use true skip connection or a simple (streamable)
convolution as the skip connection in the residual network blocks.</p></li>
<li><p><strong>compress</strong> (<em>int</em>) – Reduced dimensionality in residual branches (from Demucs v3).</p></li>
<li><p><strong>lstm</strong> (<em>int</em>) – Number of LSTM layers at the end of the encoder.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.shared.encoder.seanet_2d.SEANetEncoder2d.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet_2d.html#SEANetEncoder2d.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet_2d.SEANetEncoder2d.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.shared.encoder.seanet_2d.SEANetResnetBlock2d">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet_2d.</code><code class="sig-name descname">SEANetResnetBlock2d</code><span class="sig-paren">(</span><em class="sig-param">dim: int, kernel_sizes: List[Tuple[int, int]] = [(3, 3), (1, 1)], dilations: List[Tuple[int, int]] = [(1, 1), (1, 1)], activation: str = 'ELU', activation_params: dict = {'alpha': 1.0}, norm: str = 'weight_norm', norm_params: Dict[str, Any] = {}, causal: bool = False, pad_mode: str = 'reflect', compress: int = 2, true_skip: bool = True, conv_group_ratio: int = -1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet_2d.html#SEANetResnetBlock2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet_2d.SEANetResnetBlock2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Residual block from SEANet model.
:param dim: Dimension of the input/output
:type dim: int
:param kernel_sizes: List of kernel sizes for the convolutions.
:type kernel_sizes: list
:param dilations: List of dilations for the convolutions.
:type dilations: list
:param activation: Activation function.
:type activation: str
:param activation_params: Parameters to provide to the activation function
:type activation_params: dict
:param norm: Normalization method.
:type norm: str
:param norm_params: Parameters to provide to the underlying normalization</p>
<blockquote>
<div><p>used along with the convolution.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>causal</strong> (<em>bool</em>) – Whether to use fully causal convolution.</p></li>
<li><p><strong>pad_mode</strong> (<em>str</em>) – Padding mode for the convolutions.</p></li>
<li><p><strong>compress</strong> (<em>int</em>) – Reduced dimensionality in residual branches (from Demucs v3)</p></li>
<li><p><strong>true_skip</strong> (<em>bool</em>) – Whether to use true skip connection or a simple convolution
as the skip connection.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.shared.encoder.seanet_2d.SEANetResnetBlock2d.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet_2d.html#SEANetResnetBlock2d.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet_2d.SEANetResnetBlock2d.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</aside>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.encoder.seanet_2d.get_activation">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet_2d.</code><code class="sig-name descname">get_activation</code><span class="sig-paren">(</span><em class="sig-param">activation: str = None</em>, <em class="sig-param">channels=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet_2d.html#get_activation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet_2d.get_activation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.encoder.seanet_2d.pad2d">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet_2d.</code><code class="sig-name descname">pad2d</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor, paddings: Tuple[Tuple[int, int], Tuple[int, int]], mode: str = 'zero', value: float = 0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet_2d.html#pad2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet_2d.pad2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Tiny wrapper around F.pad, just to allow for reflect padding on small input.
If this is the case, we insert extra 0 padding to the right before
the reflection happen.</p>
</dd></dl>

<dl class="function">
<dt id="espnet2.gan_codec.shared.encoder.seanet_2d.tuple_it">
<code class="sig-prename descclassname">espnet2.gan_codec.shared.encoder.seanet_2d.</code><code class="sig-name descname">tuple_it</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">num=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/shared/encoder/seanet_2d.html#tuple_it"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.shared.encoder.seanet_2d.tuple_it" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="espnet2-gan-codec-funcodec-init-1">
<span id="espnet2-gan-codec-funcodec-init"></span><h2>espnet2.gan_codec.funcodec.__init__<a class="headerlink" href="#espnet2-gan-codec-funcodec-init-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.funcodec.__init__"></span></section>
<section id="espnet2-gan-codec-funcodec-funcodec-1">
<span id="espnet2-gan-codec-funcodec-funcodec"></span><h2>espnet2.gan_codec.funcodec.funcodec<a class="headerlink" href="#espnet2-gan-codec-funcodec-funcodec-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.funcodec.funcodec"></span><p>FunCodec Modules.</p>
<dl class="class">
<dt id="espnet2.gan_codec.funcodec.funcodec.FunCodec">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.funcodec.funcodec.</code><code class="sig-name descname">FunCodec</code><span class="sig-paren">(</span><em class="sig-param">sampling_rate: int = 24000, generator_params: Dict[str, Any] = {'codec_domain': ['time', 'time'], 'decoder_final_activation': None, 'decoder_final_activation_params': None, 'decoder_trim_right_ratio': 1.0, 'domain_conf': {}, 'encdec_activation': 'ELU', 'encdec_activation_params': {'alpha': 1.0}, 'encdec_causal': False, 'encdec_channels': 1, 'encdec_compress': 2, 'encdec_dilation_base': 2, 'encdec_kernel_size': 7, 'encdec_last_kernel_size': 7, 'encdec_lstm': 2, 'encdec_n_filters': 32, 'encdec_n_residual_layers': 1, 'encdec_norm': 'weight_norm', 'encdec_norm_params': {}, 'encdec_pad_mode': 'reflect', 'encdec_ratios': [(8, 1), (5, 1), (4, 1), (2, 1)], 'encdec_residual_kernel_size': 7, 'encdec_true_skip': False, 'hidden_dim': 128, 'quantizer_bins': 1024, 'quantizer_decay': 0.99, 'quantizer_dropout': True, 'quantizer_kmeans_init': True, 'quantizer_kmeans_iters': 50, 'quantizer_n_q': 8, 'quantizer_target_bandwidth': [7.5, 15], 'quantizer_threshold_ema_dead_code': 2}, discriminator_params: Dict[str, Any] = {'complexstft_discriminator_params': {'chan_mults': (1, 2, 4, 4, 8, 8), 'channels': 32, 'hop_length': 256, 'in_channels': 1, 'logits_abs': True, 'n_fft': 1024, 'stft_normalized': False, 'strides': ((1, 2), (2, 2), (1, 2), (2, 2), (1, 2), (2, 2)), 'win_length': 1024}, 'period_discriminator_params': {'bias': True, 'channels': 32, 'downsample_scales': [3, 3, 3, 3, 1], 'in_channels': 1, 'kernel_sizes': [5, 3], 'max_downsample_channels': 1024, 'nonlinear_activation': 'LeakyReLU', 'nonlinear_activation_params': {'negative_slope': 0.1}, 'out_channels': 1, 'use_spectral_norm': False, 'use_weight_norm': True}, 'periods': [2, 3, 5, 7, 11], 'scale_discriminator_params': {'bias': True, 'channels': 128, 'downsample_scales': [2, 2, 4, 4, 1], 'in_channels': 1, 'kernel_sizes': [15, 41, 5, 3], 'max_downsample_channels': 1024, 'max_groups': 16, 'nonlinear_activation': 'LeakyReLU', 'nonlinear_activation_params': {'negative_slope': 0.1}, 'out_channels': 1}, 'scale_downsample_pooling': 'AvgPool1d', 'scale_downsample_pooling_params': {'kernel_size': 4, 'padding': 2, 'stride': 2}, 'scale_follow_official_norm': False, 'scales': 3}, generator_adv_loss_params: Dict[str, Any] = {'average_by_discriminators': False, 'loss_type': 'mse'}, discriminator_adv_loss_params: Dict[str, Any] = {'average_by_discriminators': False, 'loss_type': 'mse'}, use_feat_match_loss: bool = True, feat_match_loss_params: Dict[str, Any] = {'average_by_discriminators': False, 'average_by_layers': False, 'include_final_outputs': True}, use_mel_loss: bool = True, mel_loss_params: Dict[str, Any] = {'fmax': None, 'fmin': 0, 'fs': 24000, 'log_base': None, 'n_mels': 80, 'range_end': 11, 'range_start': 6, 'window': 'hann'}, use_dual_decoder: bool = False, lambda_quantization: float = 1.0, lambda_reconstruct: float = 1.0, lambda_commit: float = 1.0, lambda_adv: float = 1.0, lambda_feat_match: float = 2.0, lambda_mel: float = 45.0, cache_generator_outputs: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/funcodec/funcodec.html#FunCodec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.funcodec.funcodec.FunCodec" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#espnet2.gan_codec.abs_gan_codec.AbsGANCodec" title="espnet2.gan_codec.abs_gan_codec.AbsGANCodec"><code class="xref py py-class docutils literal notranslate"><span class="pre">espnet2.gan_codec.abs_gan_codec.AbsGANCodec</span></code></a></p>
<p>“FunCodec model.</p>
<p>Intialize FunCodec model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>TODO</strong> (<em>jiatong</em>) – </p>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.funcodec.funcodec.FunCodec.decode">
<code class="sig-name descname">decode</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/espnet2/gan_codec/funcodec/funcodec.html#FunCodec.decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.funcodec.funcodec.FunCodec.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Run encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Input codes (T_code, N_stream).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated waveform (T_wav,).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.funcodec.funcodec.FunCodec.encode">
<code class="sig-name descname">encode</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/espnet2/gan_codec/funcodec/funcodec.html#FunCodec.encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.funcodec.funcodec.FunCodec.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Run encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Input audio (T_wav,).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated codes (T_code, N_stream).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.funcodec.funcodec.FunCodec.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">audio: torch.Tensor</em>, <em class="sig-param">forward_generator: bool = True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; Dict[str, Any]<a class="reference internal" href="../_modules/espnet2/gan_codec/funcodec/funcodec.html#FunCodec.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.funcodec.funcodec.FunCodec.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform generator forward.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>audio</strong> (<em>Tensor</em>) – Audio waveform tensor (B, T_wav).</p></li>
<li><p><strong>forward_generator</strong> (<em>bool</em>) – Whether to forward generator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>loss (Tensor): Loss scalar tensor.</p></li>
<li><p>stats (Dict[str, float]): Statistics to be monitored.</p></li>
<li><p>weight (Tensor): Weight tensor to summarize losses.</p></li>
<li><p>optim_idx (int): Optimizer index (0 for G and 1 for D).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.funcodec.funcodec.FunCodec.inference">
<code class="sig-name descname">inference</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; Dict[str, torch.Tensor]<a class="reference internal" href="../_modules/espnet2/gan_codec/funcodec/funcodec.html#FunCodec.inference"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.funcodec.funcodec.FunCodec.inference" title="Permalink to this definition">¶</a></dt>
<dd><p>Run inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Input audio (T_wav,).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>wav (Tensor): Generated waveform tensor (T_wav,).</p></li>
<li><p>codec (Tensor): Generated neural codec (T_code, N_stream).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.funcodec.funcodec.FunCodec.meta_info">
<code class="sig-name descname">meta_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Dict[str, Any]<a class="reference internal" href="../_modules/espnet2/gan_codec/funcodec/funcodec.html#FunCodec.meta_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.funcodec.funcodec.FunCodec.meta_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Return meta information of the codec.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.funcodec.funcodec.FunCodecDiscriminator">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.funcodec.funcodec.</code><code class="sig-name descname">FunCodecDiscriminator</code><span class="sig-paren">(</span><em class="sig-param">scales: int = 3, scale_downsample_pooling: str = 'AvgPool1d', scale_downsample_pooling_params: Dict[str, Any] = {'kernel_size': 4, 'padding': 2, 'stride': 2}, scale_discriminator_params: Dict[str, Any] = {'bias': True, 'channels': 128, 'downsample_scales': [2, 2, 4, 4, 1], 'in_channels': 1, 'kernel_sizes': [15, 41, 5, 3], 'max_downsample_channels': 1024, 'max_groups': 16, 'nonlinear_activation': 'LeakyReLU', 'nonlinear_activation_params': {'negative_slope': 0.1}, 'out_channels': 1}, scale_follow_official_norm: bool = False, periods: List[int] = [2, 3, 5, 7, 11], period_discriminator_params: Dict[str, Any] = {'bias': True, 'channels': 32, 'downsample_scales': [3, 3, 3, 3, 1], 'in_channels': 1, 'kernel_sizes': [5, 3], 'max_downsample_channels': 1024, 'nonlinear_activation': 'LeakyReLU', 'nonlinear_activation_params': {'negative_slope': 0.1}, 'out_channels': 1, 'use_spectral_norm': False, 'use_weight_norm': True}, complexstft_discriminator_params: Dict[str, Any] = {'chan_mults': [1, 2, 4, 4, 8, 8], 'channels': 32, 'hop_length': 256, 'in_channels': 1, 'n_fft': 1024, 'stft_normalized': False, 'strides': [[1, 2], [2, 2], [1, 2], [2, 2], [1, 2], [2, 2]], 'win_length': 1024}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/funcodec/funcodec.html#FunCodecDiscriminator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.funcodec.funcodec.FunCodecDiscriminator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>FunCodec discriminator module.</p>
<p>Initialize FunCodec Discriminator module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scales</strong> (<em>int</em>) – Number of multi-scales.</p></li>
<li><p><strong>sclae_downsample_pooling</strong> (<em>str</em>) – Pooling module name for downsampling of the
inputs.</p></li>
<li><p><strong>scale_downsample_pooling_params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Parameters for the above
pooling module.</p></li>
<li><p><strong>scale_discriminator_params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Parameters for hifi-gan  scale
discriminator module.</p></li>
<li><p><strong>scale_follow_official_norm</strong> (<em>bool</em>) – Whether to follow the norm setting of the
official implementaion. The first discriminator uses spectral norm
and the other discriminators use weight norm.</p></li>
<li><p><strong>complexstft_discriminator_params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Parameters for the
complex stft discriminator module.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.funcodec.funcodec.FunCodecDiscriminator.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em><span class="sig-paren">)</span> &#x2192; List[List[torch.Tensor]]<a class="reference internal" href="../_modules/espnet2/gan_codec/funcodec/funcodec.html#FunCodecDiscriminator.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.funcodec.funcodec.FunCodecDiscriminator.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate forward propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Input noise signal (B, 1, T).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>List of list of each discriminator outputs,</dt><dd><p>which consists of each layer output tensors. Multi scale and
multi period ones are concatenated.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[Tensor]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.funcodec.funcodec.FunCodecGenerator">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.funcodec.funcodec.</code><code class="sig-name descname">FunCodecGenerator</code><span class="sig-paren">(</span><em class="sig-param">sample_rate: int = 24000, hidden_dim: int = 128, codebook_dim: int = 8, encdec_channels: int = 1, encdec_n_filters: int = 32, encdec_n_residual_layers: int = 1, encdec_ratios: List[Tuple[int, int]] = [(4, 1), (4, 1), (4, 2), (4, 1)], encdec_activation: str = 'ELU', encdec_activation_params: Dict[str, Any] = {'alpha': 1.0}, encdec_norm: str = 'weight_norm', encdec_norm_params: Dict[str, Any] = {}, encdec_kernel_size: int = 7, encdec_residual_kernel_size: int = 7, encdec_last_kernel_size: int = 7, encdec_dilation_base: int = 2, encdec_causal: bool = False, encdec_pad_mode: str = 'reflect', encdec_true_skip: bool = False, encdec_compress: int = 2, encdec_lstm: int = 2, decoder_trim_right_ratio: float = 1.0, decoder_final_activation: Optional[str] = None, decoder_final_activation_params: Optional[dict] = None, quantizer_n_q: int = 8, quantizer_bins: int = 1024, quantizer_decay: float = 0.99, quantizer_kmeans_init: bool = True, quantizer_kmeans_iters: int = 50, quantizer_threshold_ema_dead_code: int = 2, quantizer_target_bandwidth: List[float] = [7.5, 15], quantizer_dropout: bool = True, codec_domain: List = ('time', 'time'), domain_conf: Optional[Dict] = {}, audio_normalize: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/funcodec/funcodec.html#FunCodecGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.funcodec.funcodec.FunCodecGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>FunCodec generator module.</p>
<p>Initialize FunCodec Generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>TODO</strong> (<em>jiatong</em>) – </p>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.funcodec.funcodec.FunCodecGenerator.decode">
<code class="sig-name descname">decode</code><span class="sig-paren">(</span><em class="sig-param">codes: torch.Tensor</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/funcodec/funcodec.html#FunCodecGenerator.decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.funcodec.funcodec.FunCodecGenerator.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>FunCodec codec decoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>codecs</strong> (<em>torch.Tensor</em>) – neural codecs in shape ().</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>resynthesized audio.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.funcodec.funcodec.FunCodecGenerator.encode">
<code class="sig-name descname">encode</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">target_bw: Optional[float] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/funcodec/funcodec.html#FunCodecGenerator.encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.funcodec.funcodec.FunCodecGenerator.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>FunCodec codec encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input tensor of shape (B, 1, T).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>neural codecs in shape ().</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.funcodec.funcodec.FunCodecGenerator.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">use_dual_decoder: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/funcodec/funcodec.html#FunCodecGenerator.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.funcodec.funcodec.FunCodecGenerator.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>FunCodec forward propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – Input tensor of shape (B, 1, T).</p></li>
<li><p><strong>use_dual_decoder</strong> (<em>bool</em>) – Whether to use dual decoder for encoder out</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>resynthesized audio.
torch.Tensor: commitment loss.
torch.Tensor: quantization loss
torch.Tensor: resynthesized audio from encoder.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.funcodec.funcodec.FunCodecGenerator.freq_to_time_transfer">
<code class="sig-name descname">freq_to_time_transfer</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">scale: torch.Tensor = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/funcodec/funcodec.html#FunCodecGenerator.freq_to_time_transfer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.funcodec.funcodec.FunCodecGenerator.freq_to_time_transfer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.funcodec.funcodec.FunCodecGenerator.time_to_freq_transfer">
<code class="sig-name descname">time_to_freq_transfer</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/funcodec/funcodec.html#FunCodecGenerator.time_to_freq_transfer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.funcodec.funcodec.FunCodecGenerator.time_to_freq_transfer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="espnet2-gan-codec-soundstream-init-1">
<span id="espnet2-gan-codec-soundstream-init"></span><h2>espnet2.gan_codec.soundstream.__init__<a class="headerlink" href="#espnet2-gan-codec-soundstream-init-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.soundstream.__init__"></span></section>
<section id="espnet2-gan-codec-soundstream-soundstream-1">
<span id="espnet2-gan-codec-soundstream-soundstream"></span><h2>espnet2.gan_codec.soundstream.soundstream<a class="headerlink" href="#espnet2-gan-codec-soundstream-soundstream-1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-espnet2.gan_codec.soundstream.soundstream"></span><p>SoundStream Modules.</p>
<dl class="class">
<dt id="espnet2.gan_codec.soundstream.soundstream.SoundStream">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.soundstream.soundstream.</code><code class="sig-name descname">SoundStream</code><span class="sig-paren">(</span><em class="sig-param">sampling_rate: int = 24000, generator_params: Dict[str, Any] = {'decoder_final_activation': None, 'decoder_final_activation_params': None, 'decoder_trim_right_ratio': 1.0, 'encdec_activation': 'ELU', 'encdec_activation_params': {'alpha': 1.0}, 'encdec_causal': False, 'encdec_channels': 1, 'encdec_compress': 2, 'encdec_dilation_base': 2, 'encdec_kernel_size': 7, 'encdec_last_kernel_size': 7, 'encdec_lstm': 2, 'encdec_n_filters': 32, 'encdec_n_residual_layers': 1, 'encdec_norm': 'weight_norm', 'encdec_norm_params': {}, 'encdec_pad_mode': 'reflect', 'encdec_ratios': [8, 5, 4, 2], 'encdec_residual_kernel_size': 7, 'encdec_true_skip': False, 'hidden_dim': 128, 'quantizer_bins': 1024, 'quantizer_decay': 0.99, 'quantizer_kmeans_init': True, 'quantizer_kmeans_iters': 50, 'quantizer_n_q': 8, 'quantizer_target_bandwidth': [7.5, 15], 'quantizer_threshold_ema_dead_code': 2}, discriminator_params: Dict[str, Any] = {'complexstft_discriminator_params': {'chan_mults': (1, 2, 4, 4, 8, 8), 'channels': 32, 'hop_length': 256, 'in_channels': 1, 'logits_abs': True, 'n_fft': 1024, 'stft_normalized': False, 'strides': ((1, 2), (2, 2), (1, 2), (2, 2), (1, 2), (2, 2)), 'win_length': 1024}, 'scale_discriminator_params': {'bias': True, 'channels': 128, 'downsample_scales': [2, 2, 4, 4, 1], 'in_channels': 1, 'kernel_sizes': [15, 41, 5, 3], 'max_downsample_channels': 1024, 'max_groups': 16, 'nonlinear_activation': 'LeakyReLU', 'nonlinear_activation_params': {'negative_slope': 0.1}, 'out_channels': 1}, 'scale_downsample_pooling': 'AvgPool1d', 'scale_downsample_pooling_params': {'kernel_size': 4, 'padding': 2, 'stride': 2}, 'scale_follow_official_norm': False, 'scales': 3}, generator_adv_loss_params: Dict[str, Any] = {'average_by_discriminators': False, 'loss_type': 'mse'}, discriminator_adv_loss_params: Dict[str, Any] = {'average_by_discriminators': False, 'loss_type': 'mse'}, use_feat_match_loss: bool = True, feat_match_loss_params: Dict[str, Any] = {'average_by_discriminators': False, 'average_by_layers': False, 'include_final_outputs': True}, use_mel_loss: bool = True, mel_loss_params: Dict[str, Any] = {'fmax': None, 'fmin': 0, 'fs': 24000, 'log_base': None, 'n_mels': 80, 'range_end': 11, 'range_start': 6, 'window': 'hann'}, use_dual_decoder: bool = True, lambda_quantization: float = 1.0, lambda_reconstruct: float = 1.0, lambda_commit: float = 1.0, lambda_adv: float = 1.0, lambda_feat_match: float = 2.0, lambda_mel: float = 45.0, cache_generator_outputs: bool = False, use_loss_balancer: bool = False, balance_ema_decay: float = 0.99</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/soundstream/soundstream.html#SoundStream"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.soundstream.soundstream.SoundStream" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#espnet2.gan_codec.abs_gan_codec.AbsGANCodec" title="espnet2.gan_codec.abs_gan_codec.AbsGANCodec"><code class="xref py py-class docutils literal notranslate"><span class="pre">espnet2.gan_codec.abs_gan_codec.AbsGANCodec</span></code></a></p>
<p>“SoundStream model.</p>
<p>Intialize SoundStream model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>TODO</strong> (<em>jiatong</em>) – </p>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.soundstream.soundstream.SoundStream.decode">
<code class="sig-name descname">decode</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/espnet2/gan_codec/soundstream/soundstream.html#SoundStream.decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.soundstream.soundstream.SoundStream.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Run encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Input codes (T_code, N_stream).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated waveform (T_wav,).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.soundstream.soundstream.SoundStream.encode">
<code class="sig-name descname">encode</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/espnet2/gan_codec/soundstream/soundstream.html#SoundStream.encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.soundstream.soundstream.SoundStream.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Run encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Input audio (T_wav,).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated codes (T_code, N_stream).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.soundstream.soundstream.SoundStream.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">audio: torch.Tensor</em>, <em class="sig-param">forward_generator: bool = True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; Dict[str, Any]<a class="reference internal" href="../_modules/espnet2/gan_codec/soundstream/soundstream.html#SoundStream.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.soundstream.soundstream.SoundStream.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform generator forward.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>audio</strong> (<em>Tensor</em>) – Audio waveform tensor (B, T_wav).</p></li>
<li><p><strong>forward_generator</strong> (<em>bool</em>) – Whether to forward generator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>loss (Tensor): Loss scalar tensor.</p></li>
<li><p>stats (Dict[str, float]): Statistics to be monitored.</p></li>
<li><p>weight (Tensor): Weight tensor to summarize losses.</p></li>
<li><p>optim_idx (int): Optimizer index (0 for G and 1 for D).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.soundstream.soundstream.SoundStream.inference">
<code class="sig-name descname">inference</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; Dict[str, torch.Tensor]<a class="reference internal" href="../_modules/espnet2/gan_codec/soundstream/soundstream.html#SoundStream.inference"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.soundstream.soundstream.SoundStream.inference" title="Permalink to this definition">¶</a></dt>
<dd><p>Run inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Input audio (T_wav,).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>wav (Tensor): Generated waveform tensor (T_wav,).</p></li>
<li><p>codec (Tensor): Generated neural codec (T_code, N_stream).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.soundstream.soundstream.SoundStream.meta_info">
<code class="sig-name descname">meta_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Dict[str, Any]<a class="reference internal" href="../_modules/espnet2/gan_codec/soundstream/soundstream.html#SoundStream.meta_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.soundstream.soundstream.SoundStream.meta_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Return meta information of the codec.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.soundstream.soundstream.SoundStreamDiscriminator">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.soundstream.soundstream.</code><code class="sig-name descname">SoundStreamDiscriminator</code><span class="sig-paren">(</span><em class="sig-param">scales: int = 3, scale_downsample_pooling: str = 'AvgPool1d', scale_downsample_pooling_params: Dict[str, Any] = {'kernel_size': 4, 'padding': 2, 'stride': 2}, scale_discriminator_params: Dict[str, Any] = {'bias': True, 'channels': 128, 'downsample_scales': [2, 2, 4, 4, 1], 'in_channels': 1, 'kernel_sizes': [15, 41, 5, 3], 'max_downsample_channels': 1024, 'max_groups': 16, 'nonlinear_activation': 'LeakyReLU', 'nonlinear_activation_params': {'negative_slope': 0.1}, 'out_channels': 1}, scale_follow_official_norm: bool = False, complexstft_discriminator_params: Dict[str, Any] = {'chan_mults': [1, 2, 4, 4, 8, 8], 'channels': 32, 'hop_length': 256, 'in_channels': 1, 'n_fft': 1024, 'stft_normalized': False, 'strides': [[1, 2], [2, 2], [1, 2], [2, 2], [1, 2], [2, 2]], 'win_length': 1024}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/soundstream/soundstream.html#SoundStreamDiscriminator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.soundstream.soundstream.SoundStreamDiscriminator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>SoundStream discriminator module.</p>
<p>Initialize SoundStream Discriminator module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scales</strong> (<em>int</em>) – Number of multi-scales.</p></li>
<li><p><strong>sclae_downsample_pooling</strong> (<em>str</em>) – Pooling module name for downsampling of the
inputs.</p></li>
<li><p><strong>scale_downsample_pooling_params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Parameters for the above
pooling module.</p></li>
<li><p><strong>scale_discriminator_params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Parameters for hifi-gan  scale
discriminator module.</p></li>
<li><p><strong>scale_follow_official_norm</strong> (<em>bool</em>) – Whether to follow the norm setting of the
official implementaion. The first discriminator uses spectral norm
and the other discriminators use weight norm.</p></li>
<li><p><strong>complexstft_discriminator_params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Parameters for the
complex stft discriminator module.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.soundstream.soundstream.SoundStreamDiscriminator.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em><span class="sig-paren">)</span> &#x2192; List[List[torch.Tensor]]<a class="reference internal" href="../_modules/espnet2/gan_codec/soundstream/soundstream.html#SoundStreamDiscriminator.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.soundstream.soundstream.SoundStreamDiscriminator.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate forward propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Input noise signal (B, 1, T).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>List of list of each discriminator outputs,</dt><dd><p>which consists of each layer output tensors. Multi scale and
multi period ones are concatenated.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[Tensor]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="espnet2.gan_codec.soundstream.soundstream.SoundStreamGenerator">
<em class="property">class </em><code class="sig-prename descclassname">espnet2.gan_codec.soundstream.soundstream.</code><code class="sig-name descname">SoundStreamGenerator</code><span class="sig-paren">(</span><em class="sig-param">sample_rate: int = 24000, hidden_dim: int = 128, encdec_channels: int = 1, encdec_n_filters: int = 32, encdec_n_residual_layers: int = 1, encdec_ratios: List[int] = [8, 5, 4, 2], encdec_activation: str = 'ELU', encdec_activation_params: Dict[str, Any] = {'alpha': 1.0}, encdec_norm: str = 'weight_norm', encdec_norm_params: Dict[str, Any] = {}, encdec_kernel_size: int = 7, encdec_residual_kernel_size: int = 7, encdec_last_kernel_size: int = 7, encdec_dilation_base: int = 2, encdec_causal: bool = False, encdec_pad_mode: str = 'reflect', encdec_true_skip: bool = False, encdec_compress: int = 2, encdec_lstm: int = 2, decoder_trim_right_ratio: float = 1.0, decoder_final_activation: Optional[str] = None, decoder_final_activation_params: Optional[dict] = None, quantizer_n_q: int = 8, quantizer_bins: int = 1024, quantizer_decay: float = 0.99, quantizer_kmeans_init: bool = True, quantizer_kmeans_iters: int = 50, quantizer_threshold_ema_dead_code: int = 2, quantizer_target_bandwidth: List[float] = [7.5, 15]</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/soundstream/soundstream.html#SoundStreamGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.soundstream.soundstream.SoundStreamGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>SoundStream generator module.</p>
<p>Initialize SoundStream Generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>TODO</strong> (<em>jiatong</em>) – </p>
</dd>
</dl>
<dl class="method">
<dt id="espnet2.gan_codec.soundstream.soundstream.SoundStreamGenerator.decode">
<code class="sig-name descname">decode</code><span class="sig-paren">(</span><em class="sig-param">codes: torch.Tensor</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/soundstream/soundstream.html#SoundStreamGenerator.decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.soundstream.soundstream.SoundStreamGenerator.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Soundstream codec decoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>codecs</strong> (<em>torch.Tensor</em>) – neural codecs in shape ().</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>resynthesized audio.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.soundstream.soundstream.SoundStreamGenerator.encode">
<code class="sig-name descname">encode</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">target_bw: Optional[float] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/soundstream/soundstream.html#SoundStreamGenerator.encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.soundstream.soundstream.SoundStreamGenerator.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Soundstream codec encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input tensor of shape (B, 1, T).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>neural codecs in shape ().</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="espnet2.gan_codec.soundstream.soundstream.SoundStreamGenerator.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x: torch.Tensor</em>, <em class="sig-param">use_dual_decoder: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/espnet2/gan_codec/soundstream/soundstream.html#SoundStreamGenerator.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#espnet2.gan_codec.soundstream.soundstream.SoundStreamGenerator.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Soundstream forward propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – Input tensor of shape (B, 1, T).</p></li>
<li><p><strong>use_dual_decoder</strong> (<em>bool</em>) – Whether to use dual decoder for encoder out</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>resynthesized audio.
torch.Tensor: commitment loss.
torch.Tensor: quantization loss
torch.Tensor: resynthesized audio from encoder.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="espnet2.samplers.html" class="btn btn-neutral float-left" title="espnet2.samplers package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="espnet2.diar.html" class="btn btn-neutral float-right" title="espnet2.diar package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, Shinji Watanabe.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>